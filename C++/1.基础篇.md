## Key Points of Cpp

### 1.ä¸ºä»€ä¹ˆä¼šå‡ºç°é¢å‘å¯¹è±¡

- C è¯­è¨€ï¼šé¢å‘è¿‡ç¨‹ï¼Œå®šä¹‰çš„æ•°æ®æ‰€æœ‰å‡½æ•°éƒ½å¯ä»¥è®¿é—®
- é¢å‘å¯¹è±¡ï¼šå¯ä»¥å°† **æ•°æ®** åŠ **ä½¿ç”¨è¿™äº›æ•°æ®çš„å‡½æ•°** æ”¾åœ¨ä¸€èµ·ï¼ˆç±»ï¼‰ - æ¯ä¸ªå‡½æ•°åªå¯ä»¥è®¿é—®å®ƒéœ€è¦è®¿é—®çš„æ•°æ®ï¼Œä¸ä¼šæ··æ‚åœ¨ä¸€èµ·

![image-20250515112557763](https://raw.githubusercontent.com/mumushu1/Pictures/main/11122e55a971b4d6748066a57f6409f0.png)	

### 2.å¤´æ–‡ä»¶é˜²å«å¼å£°æ˜

- ä½œç”¨ï¼šè‹¥ä¸€ä¸ªå¤´æ–‡ä»¶è¢«åŒ…å«å¤šæ¬¡ï¼Œé˜²æ­¢ **é‡å¤å®šä¹‰**
- æ¯”å¦‚ **`include "a.h"`** å’Œ **`include "b.h"`** ï¼Œå¦‚æœ b.h é‡Œé¢åˆå¼•ç”¨ a.hï¼Œåœ¨ç¼–è¯‘æ—¶ a.h å°±ä¼šè¢«ç¼–è¯‘ä¸¤æ¬¡

```cpp
#ifndef CPP_STL_COMPLEX_H
#define CPP_STL_COMPLEX_H

class complex {

};

#endif //CPP_STL_COMPLEX_H
```

- å¦ä¸€ç§æ–¹å¼ï¼š `#param once`ï¼Œå‘Šè¯‰ç¼–è¯‘å™¨â€œè¿™ä¸ªæ–‡ä»¶åªåŒ…å«ä¸€æ¬¡â€

```cpp
#param once
class Person{};
```

### 3.å†…è”å‡½æ•° - inline

- å‡½æ•°çš„è°ƒç”¨è¿‡ç¨‹
- å­˜åœ¨å³åˆç†ï¼šä¸€äº›å‡½æ•°ä½“è¾ƒå°ï¼Œæ¯”å¦‚åªè¿›è¡Œ **ç®€å•** çš„åŠ æ³•å¹¶è¿”å›ï¼Œæ‰§è¡Œè¿™ç§å‡½æ•°æ—¶ï¼Œåœ¨ **å‚æ•°ä¼ é€’ã€ä¿å­˜ä¸Šä¸‹æ–‡** ç­‰å‡½æ•°è°ƒç”¨çš„æ“ä½œä¸ŠèŠ±è´¹çš„æ—¶é—´ç”šè‡³å¤§äºæ‰§è¡Œå‡½æ•°æœ¬èº«çš„æ—¶é—´
- å†…è”åšäº†ä»€ä¹ˆï¼šç¼–è¯‘å™¨ä¼šåœ¨è°ƒç”¨å¤„ **ç›´æ¥å±•å¼€å‡½æ•°ä»£ç **ï¼Œè€Œä¸æ˜¯èµ°ä¸€æ¬¡â€œè°ƒç”¨+è¿”å›â€çš„æµç¨‹ã€‚
- ğŸ¯ **åœ¨ç±»å†…å®šä¹‰çš„å‡½æ•°ï¼Œé»˜è®¤å°±æ˜¯ `inline` çš„ï¼Œ** ç±»å¤–å®šä¹‰çš„å‡½æ•°ï¼Œå¦‚æœæƒ³å†…è”ï¼Œéœ€è¦åŠ å…³é”®å­— inline

```cpp
inline int add(int a,int b) {
    return a + b;}
```

- **inline åªæ˜¯ç»™ç¼–è¯‘å™¨å»ºè®®ï¼Œæœ€åæ˜¯å¦ä¸ºå†…è”ç¼–è¯‘å™¨è‡ªæœ‰å®šå¤º**
  - å³ä½¿ä½ æ²¡å†™ `inline`ï¼Œç¼–è¯‘å™¨ä¹Ÿå¯èƒ½å†…è”ï¼ˆä¼˜åŒ–é˜¶æ®µè‡ªåŠ¨å†³å®šï¼‰
  - å³ä½¿ä½ å†™äº† `inline`ï¼Œç¼–è¯‘å™¨ä¹Ÿå¯èƒ½ä¸å†…è”ï¼ˆæ¯”å¦‚å‡½æ•°è¿‡å¤§ã€æœ‰é€’å½’ç­‰æƒ…å†µï¼‰

- â‘  ä¸é€‚åˆå†…è”ï¼šå‡½æ•°å¤æ‚ã€æœ‰é€’å½’ï¼Œè™šå‡½æ•° â‘¡ é€‚åˆå†…è”ï¼šçŸ­å°ï¼Œç®€å•

### 4.è®¿é—®çº§åˆ«

- publicï¼šå¯ä»¥è¢«ç±»å¤–çš„å‡½æ•°è®¿é—®ï¼Œå¦‚æœæƒ³è®©ç±»ä¸­çš„å‡½æ•°è¢«å¤–ç•Œä½¿ç”¨ï¼Œå°±å°†è¿™äº›å‡½æ•°æ”¾åœ¨ public ä¸­
- private
    - åªæœ‰ç±»å†…çš„å‡½æ•°æ‰å¯è®¿é—®ï¼Œ**ä¸€èˆ¬å­˜æ”¾ç±»ä¸­å®šä¹‰çš„æ•°æ®**ï¼Œè¿™ä¹Ÿæ˜¯é¢å‘å¯¹è±¡æœ¬æ¥çš„ç›®çš„ï¼Œå°†æ•°æ®åŠè®¿é—®æ•°æ®çš„å‡½æ•°æ”¾åœ¨ä¸€ä¸ªç±»ä¸­
    - å½“ç„¶å¦‚æœæƒ³å®šä¹‰ä¸€ä¸ªåªèƒ½åœ¨ç±»ä¸­æ‰èƒ½ä½¿ç”¨çš„å‡½æ•°ï¼Œä¹Ÿå¯ä»¥å°†è¿™ä¸ªå‡½æ•°æ”¾åœ¨ private ä¸­
- protectï¼šæš‚æœªæ¶‰åŠ
- å°†æˆå‘˜å˜é‡è®¾ä¸º `private` æ˜¯ä¸ºäº†å°è£…å’Œå®‰å…¨ï¼Œå°†è®¿é—®æ¥å£ `real()` å’Œ `imag()` è®¾ä¸º `public` æ˜¯ä¸ºäº†å—æ§åœ°æä¾›è¯»å–åŠŸèƒ½ã€‚äºŒè€…ä¸çŸ›ç›¾ï¼Œè€Œæ˜¯é…åˆè‰¯å¥½ã€‚

```cpp
class complex {
public:
    complex(double r = 0,double i = 0) : re(r),im(i){}
    
    double real() const {
        return re;
    }
    double imag() const {
        return im;
    }

private:
    double re,im;//å®éƒ¨å’Œè™šéƒ¨
};

int main() {
    complex obj(1,2);
    obj.re = 2;
    //ä½¿ç”¨ç±»å†…å‡½æ•°è®¿é—®ç±»ä¸­ç§æœ‰å˜é‡
    double re = obj.real();
    double im = obj.imag();
    cout << "re = " << re << " im = " << im << endl;

    //ä½¿ç”¨ç±»å¤–å‡½æ•°è®¿é—®ç±»ä¸­ç§æœ‰å˜é‡ï¼ˆé”™è¯¯ï¼‰
    cout << obj.re;

    return 0;
}
```

### 5.æ„é€ -é‡è½½ï¼Œå•ä¾‹è®¾è®¡æ¨¡å¼

- æ„é€ å‡½æ•°çš„ **åˆå§‹åˆ— `complex(double r,double i) : re(r),im(i) {}`**
- ä¸€ä¸ªç±»å¯ä»¥æœ‰å¤šä¸ªæ„é€ å‡½æ•°ï¼Œå› ä¸ºä¼šå­˜åœ¨ **å¤šç§ä¸åŒçš„å®šä¹‰å®ä¾‹çš„æ–¹å¼** ï¼Œè™½ç„¶æ¯ä¸ªæ„é€ å‡½æ•°çš„åç§°éƒ½ç›¸åŒï¼Œä½† **ç¼–è¯‘å™¨å¯¹äºè¿™äº›å‡½æ•°çš„æ ‡è®°æ˜¯ä¸åŒçš„**ï¼Œç¼–è¯‘å™¨å¯ä»¥æ ¹æ®åç§°ã€è¿”å›å€¼ã€å‚æ•°ç­‰æŠŠä¸€ä¸ªå‡½æ•°èµ‹äºˆä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†
- å°† **æ„é€ å‡½æ•°æ”¾åœ¨ private ä¸­ï¼Œå¹¶åœ¨ public æä¾›é™æ€å®ä¾‹ï¼Œå¯å½¢æˆå•ä¾‹è®¾è®¡æ¨¡å¼**  - ä¸€ä¸ªç±»ä¸å…è®¸å¤–ç•Œåˆ›å»ºå®ä¾‹ï¼Œåªå¯¹å¤–æä¾›å”¯ä¸€å®ä¾‹

```cpp
class A {
public:
    static A& getInstance();

private:
    A();
    A(const A& rhs);
};

A& A :: getInstance() {
    static A a;
    return a;
}
```

### 6.å¸¸é‡å‡½æ•°

- å³åœ¨å‡½æ•°å‚æ•°åˆ—è¡¨ä¹‹åï¼Œå‡½æ•°ä½“ä¹‹å‰ï¼ŒåŠ å…¥ const å…³é”®å­—
- **åªé€‚ç”¨äºç±»çš„æˆå‘˜å‡½æ•°ï¼ŒåŠ ä¸Šconstè¡¨ç¤ºæ­¤å‡½æ•°ä¸ä¼šé€šè¿‡thisæŒ‡é’ˆæ”¹å˜ç±»æˆå‘˜å˜é‡çš„å€¼ï¼Œè€Œå¯¹äºå…¨å±€å‡½æ•°ï¼Œå› ä¸ºæ²¡æœ‰thisæŒ‡é’ˆå’Œæˆå‘˜å˜é‡ï¼Œæ‰€ä»¥è‡ªç„¶ä¹Ÿæ²¡æœ‰åŠ ä»constè¿™ä¸ªè¯´æ³•**

```cpp
  double real() const {return re;}
  double imag() const {return im;}
  
  const complex obj(1,2);
```

- ä½œç”¨ï¼š **è‹¥å‡½æ•°ä¼šæ”¹å˜å˜é‡çš„å€¼ï¼Œåˆ™ä¸åŠ  constï¼Œå¦åˆ™åŠ  const**
- å¦‚æœè¿™ä¸ªå‡½æ•°æ²¡æœ‰æ”¹å˜å˜é‡çš„å€¼ï¼Œä»¥ä¸Šé¢çš„ real()å’Œ imag()ä¸ºä¾‹ï¼Œå¦‚æœå®ƒä»¬æ²¡æœ‰åŠ  constï¼Œåœ¨åˆ›å»ºå¯¹è±¡æ—¶ï¼Œå°±æ— æ³•åˆ›å»º const ç±»å‹çš„å¯¹è±¡
    - ç›´è§‚ç†è§£å°±æ˜¯ï¼šä½ åœ¨åˆ›å»ºå¯¹è±¡æ—¶å¸Œæœ›è¿™ä¸ªå¯¹è±¡æ˜¯ constï¼Œä¹Ÿå°±æ˜¯ **ä¸å¯ä¿®æ”¹çš„ï¼Œ** ä½†ä½ çš„ **å‡½æ•°** æ²¡åŠ  constï¼Œå³å‡½æ•°è®¤ä¸ºæ˜¯å¯ä¿®æ”¹çš„ï¼Œè¿™å°±ä¼šçŸ›ç›¾ï¼›
    - æ‰€ä»¥å¦‚æœä½ ä¸åˆ›å»º const ç±»å‹çš„å¯¹è±¡ï¼Œå¯¹äºä¸ä¼šä¿®æ”¹å€¼çš„å‡½æ•°ä¸åŠ  const ä¹Ÿä¸ä¼šæŠ¥é”™ï¼Œä½†ä¸æ¨èï¼
- **å†™ä»£ç çš„ä¹ æƒ¯ï¼šå¯¹äºä¸ä¼šä¿®æ”¹å˜é‡å€¼çš„å‡½æ•°ï¼Œä¸€å¾‹å†™æˆå¸¸é‡å‡½æ•°**

### 7.å‚æ•°ä¼ é€’ï¼ˆå€¼ã€å¼•ç”¨ã€æŒ‡é’ˆï¼‰

- å€¼ä¼ é€’ï¼šå°±æ˜¯æŠŠéœ€è¦ä¼ é€’çš„å˜é‡ä¸€æ•´ä¸ªæ¬è¿‡å»ï¼Œå‹åˆ°æ ˆä¸­ï¼Œä¸è®ºè¿™ä¸ªå‚æ•°æœ‰å¤šå¤§ï¼Œæ¯”å¦‚å€¼ä¼ é€’ä¸€ä¸ªå¤§å°ä¸º 100 çš„æ•´å‹æ•°ç»„ï¼Œé‚£ä¹ˆ 400B çš„æ•°æ®å°±ä¼šè¢«å‹æ ˆ
- å¼•ç”¨ä¼ é€’ï¼šä¼ å¼•ç”¨å°±ç†è§£ä¸ºä¼ æŒ‡é’ˆï¼Œä¹Ÿå°±æ˜¯ä¼ è¿™ä¸ªå‚æ•°çš„ **åœ°å€**
- å†™ä»£ç çš„å¤§æ–¹å‘ï¼šæ‰€æœ‰çš„å‚æ•°ä¼ é€’éƒ½ä¼ å¼•ç”¨ï¼Œçœç©ºé—´ï¼Œæ•ˆç‡æ›´é«˜
- éƒ½ä¼ å¼•ç”¨çš„é—®é¢˜ï¼šæˆ‘ä»¬çŸ¥é“ï¼Œå€¼ä¼ é€’åœ¨å‡½æ•°å†…éƒ¨æ˜¯ä¸èƒ½ä¿®æ”¹å‚æ•°å€¼çš„ï¼Œè€Œå¼•ç”¨ä¼ é€’å¯ä»¥ï¼Œé‚£ **å¦‚ä½•åœ¨ä¼ å¼•ç”¨çš„å‰æä¸‹ï¼Œè¿˜è¦æ±‚å‡½æ•°ä¸æ”¹å˜å‚æ•°çš„å€¼ï¼Ÿç­”æ¡ˆå°±æ˜¯ä¼  const å¼•ç”¨**ï¼Œæ¯”å¦‚ä¹‹å‰å†™è¿‡çš„æŒ‰ pair çš„ key æ’åºçš„å‡½æ•°

```cpp
auto cmp = [](const pair<int,int> &pair1 , const pair<int,int> &pair2) {
    return pair1.first < pair2.first;
};
```

- cosnt è¡¨ç¤ºå³ä½¿ä¼ çš„æ˜¯å¼•ç”¨ï¼Œä½†æ˜¯åœ¨å‡½æ•°å†…éƒ¨ä¹Ÿä¸èƒ½ä¿®æ”¹è¿™ä¸ªå‚æ•°çš„å€¼
- å‡½æ•°è¿”å›ç±»å‹ä¹Ÿæœ‰è¿”å›å€¼ä»¥åŠè¿”å›å¼•ç”¨ï¼Œå†™ä»£ç æ—¶ï¼Œå¦‚æœ **å¯ä»¥è¿”å›å¼•ç”¨**ï¼Œé‚£å°±è¿”å›å¼•ç”¨ï¼Œå³å°½é‡è¿”å›å¼•ç”¨
    - ä»€ä¹ˆæ—¶å€™ä¸èƒ½è¿”å›å¼•ç”¨ï¼šè¿”å›å±€éƒ¨å¯¹è±¡çš„å¼•ç”¨ âŒï¼Œè¿”å›ä¸´æ—¶å¯¹è±¡çš„å¼•ç”¨ âŒ
    - ä»€ä¹ˆæ—¶å€™å¯ä»¥è¿”å›å¼•ç”¨ï¼šå½“å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ª **åœ¨å‡½æ•°å¤–ä»ç„¶æœ‰æ•ˆçš„å¯¹è±¡ï¼Œ** åˆ™å¯ä»¥è¿”å›å¼•ç”¨
- æœ€åæ¥è¯´è¯´**ä¼ æŒ‡é’ˆ**ï¼Œå’Œä¼ å¼•ç”¨ç±»ä¼¼ï¼Œéƒ½æ˜¯ä¼ ä¸€ä¸ªåœ°å€ï¼Œä½†æ˜¯**å‡½æ•°å†…ä¸èƒ½è®©å¼•ç”¨é‡æ–°ç»‘å®šï¼Œä½†å¯ä»¥è®©æŒ‡é’ˆæŒ‡å‘åˆ«çš„å¯¹è±¡**

```cpp
int func1(int num) {
    return num;
}
int func2(int& num) {
    return num;
}
int func3(int* num) {
    return *num;
}

int main() {
    int num = 5;
    func1(num);
    func2(num);//å¯ä»¥è§‚å¯Ÿåˆ°ä¼ å¼•ç”¨æ—¶ï¼Œå‡½æ•°å†…éƒ¨è®¿é—®ç›´æ¥ç”¨å˜é‡åï¼ˆå°±åƒä¼ å€¼ä¸€æ ·ï¼‰
    func3(&num);//è€Œä¼ æŒ‡é’ˆæ—¶ï¼Œå‡½æ•°å†…éƒ¨è®¿é—®éœ€è¦ä¼ ä¸€ä¸ªåœ°å€
    
    return 0;
}
```



### 8.å‹å…ƒ

- ==å‹å…ƒå‡½æ•°å¯ä»¥ä½¿ç”¨ç±»ä¸­ private å†…çš„å˜é‡ï¼ˆprotect å’Œ public è‡ªç„¶ä¹Ÿå¯ä»¥ï¼‰ï¼Œå‹å…ƒå‡½æ•°çš„æƒé™æ¯”å­ç±»è¦æ›´å¼ºä¸€ç‚¹ï¼Œå­ç±»åªèƒ½è®¿é—® public å’Œ protect==
- è¿™å…¶å®æ˜¯æ‰“å¼€äº† C++å°è£…çš„ä¸€ä¸ªå¤§é—¨
- å¦‚æœä¸ä½¿ç”¨å‹å…ƒï¼Œåˆ™åªèƒ½ä½¿ç”¨ç±»ä¸­ public ä¸­æä¾›çš„æ–¹æ³•å»æ‹¿ private ä¸­çš„å˜é‡ï¼Œæœ¬ä¾‹ä¸­å°±æ˜¯ **`real()`** å’Œ **`imag()`** ä¸¤ä¸ªå‡½æ•°
- **åŒä¸€ä¸ª class çš„ä¸åŒå¯¹è±¡ä¹‹é—´äº’ä¸ºå‹å…ƒ**

```cpp
class complex {
public:
    complex() : re(0),im(0){}
    complex(double r,double i) : re(r),im(i) {}

    int add(const complex& obj) {
        return obj.re + obj.im;
    }

    double real() const {return re;}
    double imag() const {return im;}

private:
    double re,im;//å®éƒ¨å’Œè™šéƒ¨
};
int main() {
    complex c1(1,2);
    complex c2 (2,3);
    int res = c1.add(c2); //c1 å¯ä»¥è®¿é—® c2 çš„ private å˜é‡
    cout << "res = " << res;

    return 0;
}
```

### 9.æ“ä½œç¬¦é‡è½½ 1 - æˆå‘˜å‡½æ•°

- ä»»ä½•æˆå‘˜å‡½æ•°ï¼Œéƒ½æœ‰ä¸€ä¸ªéšè—çš„å‚æ•° - this æŒ‡é’ˆï¼ˆé™¤äº†é™æ€å‡½æ•°ï¼‰ï¼Œè°è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œthis æŒ‡é’ˆå°±æŒ‡å‘è°çš„åœ°å€
- this æ˜¯ä¸€ä¸ªæŒ‡é’ˆç±»å‹ï¼Œæ‰€ä»¥å¦‚æœå‡½æ•°çš„å‚æ•°æœ‰ thisï¼Œåˆ™å‚æ•°ç±»å‹éœ€è¦ä¸ºæŒ‡é’ˆç±»å‹è€Œä¸æ˜¯å¼•ç”¨ç±»å‹
- **æ“ä½œç¬¦é‡è½½ï¼šå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæœ‰è¿”å›å€¼ï¼Œæœ‰å‚æ•°ï¼Œå‡½æ•°åå°±æ˜¯éœ€è¦é‡è½½çš„æ“ä½œç¬¦ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œåœ¨æ“ä½œç¬¦å‰åŠ ä¸Šå…³é”®å­— *operator***
- **`*ths`** æœ¬èº«åœ¨è¡¨è¾¾å¼è¯­ä¹‰ä¸Šæ˜¯ä¸€ä¸ªå·¦å€¼ï¼ˆlvalueï¼‰ï¼Œå¯ä»¥å®‰å…¨åœ°è¿”å›å¼•ç”¨ã€‚å…³é”®åœ¨äºï¼š**è¿™ä¸ªå¯¹è±¡è¿˜åœ¨å¤–éƒ¨â€œæ´»ç€â€**ï¼Œç”Ÿå‘½å‘¨æœŸæ²¡ç»“æŸï¼

```cpp
class complex {
public:
    complex() : re(0),im(0){}
    complex(double r,double i) : re(r),im(i) {}
    double real() const {return re;}
    double imag() const {return im;}

private:
    double re,im;//å®éƒ¨å’Œè™šéƒ¨

public:
		//ths æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œ*ths æ˜¯ä¸€ä¸ª complex ç±»çš„å¯¹è±¡ï¼Œè¿”å›* ths å°±ç›¸å½“äºè¿”å›äº†ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥è¿”å›å€¼æ˜¯ complex&
    complex& __doapl(complex* ths,const complex& r) {
        ths->re += r.re;
        ths->im += r.im;
        return *ths;
    }
    //this æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œæ‰€æœ‰ä¸Šé¢å¿…é¡»ä¼ ä¸€ä¸ªæŒ‡é’ˆï¼Œä¸èƒ½ä¼ å¼•ç”¨
    complex& operator += (const complex& r) {
        return __doapl(this,r);
    }
};
int main() {
    complex c1(1,2);
    complex c2 (2,3);

    c1 += c2;
    cout << c1.real() << "+" << c1.imag();//3 + 5
    return 0;
}

```

- è°ƒç”¨å‡½æ•°çš„å¯¹è±¡ï¼Œä¸éœ€è¦çŸ¥é“å‡½æ•°çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆ ï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ c1 += c2 æ—¶ï¼Œc1 æ— éœ€çŸ¥é“è¿”å›å€¼æ˜¯ complex&ç±»å‹çš„ï¼Œå¦‚æœä»…æ‰§è¡Œ c1+= c2 çš„æ“ä½œï¼Œæ“ä½œç¬¦é‡è½½å¯¹åº”å‡½æ•°çš„è¿”å›å€¼ä¹Ÿå¯ä»¥æ˜¯ voidï¼Œä½†éœ€è¦è€ƒè™‘ä½¿ç”¨æ“ä½œç¬¦çš„å¤šç§æƒ…å†µï¼Œæ¯”å¦‚å®ç° c1 += c2 += c3ï¼Œå°±éœ€è¦è¦æ±‚è¿”å›å€¼æ˜¯ complex&ç±»å‹

### 10.æ“ä½œç¬¦é‡è½½ 2 - éæˆå‘˜å‡½æ•°

- å’Œæˆå‘˜å‡½æ•°æ“ä½œç¬¦é‡è½½çš„ä¸åŒï¼šæˆå‘˜å‡½æ•°å¯ä»¥ä½¿ç”¨ this æŒ‡é’ˆ

```cpp
//class ä¹‹å¤– â‘ ï¼šå…¨å±€å‡½æ•°
inline double img(const complex& x) {
    return x.imag();
}
inline double real(const complex& x) {
    return x.real();
}
//class ä¹‹å¤– â‘¡ï¼šæ“ä½œç¬¦é‡è½½
inline complex operator + (const complex& c1,const complex& c2) {//å¤æ•° + è™šæ•°
    return complex(real(c1) + real(c2),img(c1) + img(c2)); 
}
inline complex operator + (double x,const complex& c1) {//å¤æ•° + å®éƒ¨
    return complex(real(c1) + x, img(c1));
}
inline complex operator + (const complex& c1,double y) {
    return complex (real(c1),img(c1) + y);
}

```

- å…±è½­å¤æ•° & é‡è½½ << è¾“å‡º
    - ç°ä»£ C++èƒ½å¤Ÿ cout å„ç§ç±»å‹çš„æ•°æ®ï¼Œå®é™…ä¸Šå°±æ˜¯å¯¹ << åšäº†å¾ˆå¤šæ“ä½œç¬¦é‡è½½ string
    
    ```cpp
    //å…±è½­å¤æ•°
    inline complex conj (complex& x) {
        return complex(real(x),-img(x));
    }
    //é‡è½½ <<ï¼Œè¾“å‡ºå¤æ•°
    inline ostream & operator << (ostream& os,const complex& x) {
        return os << '(' << real(x) << ',' << img(x) << 'i' << ')';
    }
    ```
    

### 11.ä¸´æ—¶å¯¹è±¡(temp object)

- ç”¨æ³•ï¼š **`typename + ()` , typename å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ˜¯ç±»**
- æ¯”å¦‚ä¸Šé¢çš„ä¸‰ä¸ªå‡½æ•°è¿”å› **`complex(real(c1)_+x,img(c2))` ï¼Œ** å°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ªä¸´æ—¶å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„ **ç”Ÿå‘½å‘¨æœŸåœ¨æœ¬è¡Œä»£ç æ‰§è¡Œå®Œå°±ç»“æŸ**
- æ‰€ä»¥ä¸Šé¢ä¸‰ä¸ªå‡½æ•°ä¸€å®šä¸èƒ½è¿”å›å¼•ç”¨

### 12.åœ¨å†™ä¸€ä¸ªç±»æ—¶çš„æ³¨æ„ç‚¹

- æ„é€ å‡½æ•°ï¼šå­¦ä¼šä½¿ç”¨ **åˆå§‹åˆ—**
- å‡½æ•°çš„å‚æ•°ä¼ é€’ï¼šå¼•ç”¨ä¼ é€’ï¼Œæ˜¯å¦éœ€è¦åŠ  const
- å‡½æ•°çš„è¿”å›å€¼ï¼šæ˜¯å¦å¯ä»¥ **return by reference**
- å‡½æ•°å®šä¹‰ï¼šæ˜¯å¦éœ€è¦æ ‡è®°ä¸º **const** â­
- æ“ä½œç¬¦é‡è½½ï¼šå®šä¹‰åœ¨ç±»å†…è¿˜æ˜¯ç±»å¤–

### 13.æ‹·è´æ„é€ ã€æ‹·è´èµ‹å€¼ã€ææ„

- å­—ç¬¦ä¸²ç±»çš„è®¾è®¡ï¼š**ä½¿ç”¨ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘å­—ç¬¦ä¸²å­˜å‚¨çš„åœ°å€**ï¼Œè€Œéç›´æ¥ä½¿ç”¨æ•°ç»„å­˜å­—ç¬¦ä¸² - å› ä¸ºå­—ç¬¦ä¸²é•¿åº¦æœ‰å¤§æœ‰å°ï¼Œå¦‚æœåœ¨ç±»ä¸­è®¾å®šä¸€ä¸ªæ•°ç»„æˆå‘˜å­˜å­—ç¬¦ä¸²ï¼Œä¸çŸ¥é“éœ€è¦è®¾å®šå¤šå¤§ã€‚
- æ‰€ä»¥å­—ç¬¦ä¸²ç±»æ˜¯ä¸€ä¸ªå¸¦æŒ‡é’ˆçš„ç±» ï¼Œ==å¯¹äºå¸¦æŒ‡é’ˆçš„ç±»ï¼Œä¸€å®šè¦è‡ªå·±å†™å‡º **æ‹·è´æ„é€ &æ‹·è´èµ‹å€¼**==

- å¦‚æœä¸è‡ªå·±å†™ï¼Œä½¿ç”¨ç¼–è¯‘å™¨æä¾›çš„æ‹·è´æ„é€ å’Œæ‹·è´å¤åˆ¶ä¼šæ€æ ·ï¼šä»¥ä¸‹é¢ä¸ºä¾‹ï¼Œå¦‚æœä½¿ç”¨ç¼–è¯‘å™¨çš„èµ‹å€¼ï¼Œä¼šä½¿ b çš„æŒ‡é’ˆæŒ‡å‘ a æŒ‡å‘çš„åœ°æ–¹ï¼Œå¯¼è‡´ b åŸæ¥æŒ‡å‘çš„ä¸œè¥¿æ²¡æœ‰æŒ‡é’ˆæŒ‡å‘äº† **ï¼ˆå†…å­˜æ³„æ¼ï¼‰**ï¼Œb å’Œ a å…±åŒæŒ‡å‘ä¸€ä¸ªä½ç½®ï¼Œå…¶ä¸­ä¸€ä¸ªææ„ä¹Ÿä¼šå‡ºç°é—®é¢˜ï¼Œè¿™ç§æ‹·è´ç§°ä¸º **æµ…æ‹·è´ï¼ˆåªæ‹·è´æŒ‡é’ˆï¼‰ï¼Œ** æˆ‘ä»¬åé¢è‡ªå·±å®ç°çš„æ‹·è´å¤åˆ¶ï¼Œå¯ä»¥å®ç°**æ·±æ‹·è´**

<img src="https://raw.githubusercontent.com/mumushu1/Pictures/main/4e53f407045d57fe54e97c245dc6d5f7.png" alt="image-20250515112654042" style="zoom: 67%;" />	

```cpp
//æ„é€ å‡½æ•°
inline String ::String(const char* str) {
    if (str) {
        m_data = new char[strlen(str) + 1];
        strcpy(m_data,str);
    }
    else {
        m_data = new char[1];
        *m_data = '\0';
    }
}
//æ‹·è´æ„é€ å‡½æ•°ï¼šç›´æ¥å–ç›®æ ‡ str çš„å†…å®¹ä½œä¸ºè‡ªå·±çš„å†…å®¹ï¼ˆæ·±æ‹·è´ï¼‰
inline String ::String(const String &str) {
    m_data = new char[strlen(str.m_data) + 1];
    strcpy(m_data,str.m_data);//strcpy å°†æŒ‡é’ˆæŒ‡å‘çš„å†…å®¹å¤åˆ¶
}
//æ‹·è´èµ‹å€¼
inline String &String::operator=(const String &str) {
    //æ£€æµ‹è‡ªæˆ‘èµ‹å€¼ï¼šè¿™ä¸€æ­¥çš„å¿…è¦çš„ï¼Œå¦‚æœè‡ªå·±æ‹·è´è‡ªå·±ï¼Œæ²¡æœ‰è¿™ä¸€æ­¥ç›´æ¥æ‰§è¡Œ delete [] m_dataï¼Œä¼šå°†è‡ªå·±åˆ æ‰ï¼Œæ— æ³•è¿›è¡Œåé¢çš„æ‹·è´å·¥ä½œ
    if (this == &str) {
        return *this;
    }
    delete[] m_data;
    m_data = new char[strlen(str.m_data) + 1];
    strcpy(m_data,str.m_data);
    return *this;
}
//ææ„å‡½æ•°
inline String :: ~String() {
    delete[] m_data;
}
```

- ä¸æ‹·è´æ„é€ ç±»ä¼¼ï¼ˆä½†ä¸æ˜¯ï¼‰çš„æ„é€ å‡½æ•°é‡è½½

  - `basic_string(const basic_string& str, size_type pos, size_type len = npos);`
  - ä»å­—ç¬¦ä¸²strçš„ä¸‹æ ‡poså¼€å§‹ï¼Œæ‹·è´é•¿åº¦ä¸ºlençš„å­ä¸²
  - **æ‹·è´æ„é€ æœ¬èº«ä¹Ÿæ˜¯æ„é€ å‡½æ•°é‡è½½ï¼Œåªæ˜¯æŠŠè¿™ä¸€ç§é‡è½½æ–¹å¼å•æ‹å‡ºæ¥å‘½åä¸ºæ‹·è´æ„é€ **

  ```cpp
  string str2 = "hello";
  
  string str4(str2,0,4);
  ```

### 14.static

- é™æ€æ•°æ®&é™æ€å‡½æ•°ï¼šä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ª
    - é™æ€å‡½æ•°æ²¡æœ‰ this æŒ‡é’ˆä½œä¸ºå‚æ•°ï¼ˆå…¶ä»–æˆå‘˜å‡½æ•°é»˜è®¤æœ‰ this æŒ‡é’ˆä½œä¸ºå‚æ•°ï¼‰
    - **é™æ€å‡½æ•°åªèƒ½å¤„ç†é™æ€æ•°æ®**
- è°ƒç”¨é™æ€å‡½æ•°&é™æ€å˜é‡çš„ä¸¤ç§æ–¹å¼
    - é€šè¿‡å¯¹è±¡è°ƒç”¨ï¼ˆå’Œæ™®é€šæˆå‘˜å˜é‡&æˆå‘˜å‡½æ•°è°ƒç”¨æ–¹æ³•ç›¸åŒï¼‰
    - é€šè¿‡ç±»åç›´æ¥è°ƒç”¨ **`Account::m_rate`**
- éœ€è¦ä½¿ç”¨é™æ€çš„åœºæ™¯ï¼šæ¯”å¦‚è´¦æˆ·ç±»ï¼Œæ¯ä¸ªæˆå‘˜å¯ä»¥æœ‰è‡ªå·±çš„å­˜æ¬¾ã€åˆ©æ¯ï¼Œä½†æ¯ä¸ªäººçš„åˆ©ç‡æ˜¯ç›¸åŒçš„ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªç±»ä¸­åªéœ€è¦ä¸€ä¸ªåˆ©ç‡ï¼Œé‚£ä¹ˆå°±æŠŠè¿™ä¸ªåˆ©ç‡è®¾ä¸ºé™æ€

```cpp
class Account {
public:
    static double m_rate;//åˆ©ç‡

    static void set_rate(const double& x) {
        m_rate = x;
    }
};
double Account::m_rate = 9.0;//å¦‚ä½•èµ‹å€¼

int main() {
    Account obj;
    cout << obj.m_rate << endl;

    //ç›´æ¥ä½¿ç”¨ç±»åè®¿é—®é™æ€æˆå‘˜å‡½æ•°å’Œé™æ€æˆå‘˜å˜é‡
    Account::set_rate(5.0);
    cout << Account::m_rate;
}
```

### 15.æ¨¡æ¿

- ç±»æ¨¡æ¿ï¼šç±»çš„æˆå‘˜å˜é‡å¯ä»¥æœ‰ä¸åŒçš„ç±»å‹

```cpp
template<typename T>

class lr_template {
public:
    lr_template(const T& r,const T& i) : re(r),im(i){}
    T get_re() const {return re;}
    T get_im() const {return im;}

private:
    T re;
    T im;
};

int main() {
    lr_template<int> c1(12,3);
    lr_template<float> c2(2.1,32.4);
}
```

- å‡½æ•°æ¨¡æ¿

```cpp
class Stone {
public:
    Stone(int w,int h,int weight) : w(w),h(h),weight(weight){}

    bool operator < (const Stone& sto) const {
        return this->weight < sto.weight;
    }

    int get_weight() const {
        return this->weight;
    }

private:
    int w,h,weight;
};

template<typename T>
inline const T& min_cl(const T& a,const T& b) {
    return a < b ? a : b;
}

int main() {
    Stone s1(1,1,2);
    Stone s2(1,1,3);
    //è°ƒç”¨æ—¶è‡ªåŠ¨æ¨å¯¼å‚æ•°ç±»å‹
    auto res = min_cl(s1,s2);
    cout << "è¾ƒå°çš„weightä¸º:" << res.get_weight() << endl;

    return 0;
}
```

- ç±»æ¨¡æ¿å’Œå‡½æ•°æ¨¡æ¿æ€»ç»“
    - ç±»æ¨¡æ¿ç”¨äºå†™ **é€šç”¨çš„æ•°æ®ç»“æ„ç±»ï¼Œ** å‡½æ•°æ¨¡æ¿ç”¨äºå†™ **é€šç”¨ç®—æ³•å‡½æ•°**
    - ç±»æ¨¡æ¿åœ¨åˆ›å»ºå¯¹è±¡æ—¶å¿…é¡» **æŒ‡å®š** ç±»å‹ï¼Œå‡½æ•°æ¨¡æ¿åœ¨è°ƒç”¨æ—¶ **è‡ªåŠ¨æ¨å¯¼ç±»å‹**

### 16.å‘½åç©ºé—´

- ä½œç”¨ï¼šé¿å…å‘½åå†²çªï¼Œåœ¨åŒä¸€å‘½åç©ºé—´ä¸­ï¼Œä¸èƒ½å‡ºç°åå­—ç›¸åŒåŠŸèƒ½ä¸åŒçš„å‡½æ•°ï¼ˆé™¤äº†é‡è½½ï¼‰ï¼Œä¸åŒå‘½åç©ºé—´ä¸­åˆ™å¯ä»¥
- C++çš„æ ‡å‡†åº“å®šä¹‰åœ¨ std å‘½åç©ºé—´ä¸­

```cpp
#include <iostream>
namespace MySpace{
    void printf() {
        std::cout << "This is my namespace" << std::endl;
    }
}

int main() {
	using namespace MySpace;
  printf();//This is my namespace
}
```

- ä¸‰ç§æŒ‡å®šå‘½åç©ºé—´çš„æ–¹æ³•

> å¤´æ–‡ä»¶ä¸€èˆ¬ä¸åº”è¯¥ä½¿ç”¨usingå£°æ˜ï¼Œå› ä¸ºå¤´æ–‡ä»¶çš„å†…å®¹ä¼šæ‹·è´åˆ°å¼•ç”¨å…¶çš„æ–‡ä»¶ä¸­ï¼Œè‹¥å¤´æ–‡ä»¶ä¸­æœ‰usingå£°æ˜ï¼Œé‚£ä¹ˆæ¯ä¸ªincludeè¯¥å¤´æ–‡ä»¶çš„æ–‡ä»¶éƒ½ä¼šæœ‰è¿™ä¸ªå£°æ˜

```cpp
//æ³•ä¸€
using namespce std;

//æ³•äºŒï¼šä»…ä½¿ç”¨å‘½åç©ºé—´ä¸­çš„æŸå‡ ä¸ªå‡½æ•°
using std::cout;// from xx import xx

//æ³•ä¸‰ï¼šç›´æ¥åœ¨ä½¿ç”¨å‰å£°æ˜
std::cout << "hello" << std::endl;
```

ä»¥ä¸Šå†…å®¹æ˜¯å…³äº **åŸºäºå¯¹è±¡çš„è®¾è®¡**ï¼Œå³è®¾è®¡å•ä¸€çš„ç±»ï¼Œæ— è®ºè¿™ä¸ªç±»æ˜¯å¦å¸¦æŒ‡é’ˆï¼Œä¸‹é¢çš„å†…å®¹æ˜¯å…³äº **é¢å‘å¯¹è±¡çš„è®¾è®¡**ï¼Œå³ç±»ä¸ç±»ä¹‹é—´å…·æœ‰ **å…³ç³»** 

### 17.ç±»ä¸ç±»ä¹‹é—´çš„å…³ç³»

- compositionï¼ˆå¤åˆï¼‰
- inheritanceï¼ˆç»§æ‰¿ï¼‰
- delegationï¼ˆå§”æ‰˜ï¼‰

### 18.compositionå¤åˆ(has-a)

- å¤åˆæ˜¯æŒ‡ **ä¸€ä¸ªç±»ä¸­æœ‰å¦ä¸€ä¸ªç±»çš„å¯¹è±¡ä½œä¸ºæˆå‘˜å˜é‡**
- æ¯”å¦‚é˜Ÿåˆ— queue å’ŒåŒç«¯é˜Ÿåˆ— dequeï¼Œä¸€ä¸ªç±»çš„æˆå‘˜å‡½æ•°ç›´æ¥ä½¿ç”¨å¦ä¸€ä¸ªç±»çš„æˆå‘˜å‡½æ•°
- å½¢æˆçš„è®¾è®¡æ¨¡å¼ï¼š***adapter é€‚é…å™¨***ï¼Œä½¿ç”¨å¤åˆæ¥å®ç°â€œè¡Œä¸ºè½¬å‘â€œï¼Œå³ä¸‹é¢ queue ç±»ä¸­ deque ç±»çš„å¯¹è±¡è°ƒç”¨è‡ªå·±çš„å‡½æ•°
  
    <img src="https://raw.githubusercontent.com/mumushu1/Pictures/main/b90145630b1d47c4f27e408c59f96b90.png" alt="image-20250515112731756" style="zoom:80%;" />		
    
- ä¸‹é¢çš„ä¾‹å­å°±ç±»ä¼¼äº DS ä¸­çš„é‚»æ¥è¡¨æ•°æ®ç»“æ„ï¼Œåœ¨ä¸€ä¸ª struct ALGraph ä¸­å­˜åœ¨ struct VNode ç±»å‹çš„å¯¹è±¡

<img src="https://raw.githubusercontent.com/mumushu1/Pictures/main/9a6802ef0b67068f34c39becba764933.png" alt="image-20250515112754358" style="zoom: 80%;" />	

```cpp
typedef struct ArcNode{
	int data;
	struct ArcNode* next;
}ArcNode;

typedef struct VNode{
	int data;
	struct ArcNode* first;
}VNode;

typedef struct{
	struct VNode* List[maxsize];
	int numv,nume;
}ALGraph;
```

- å¤åˆå…³ç³»ä¸‹çš„æ„é€ å’Œææ„ï¼ˆç¼–è¯‘å™¨æ‰§è¡Œçš„é¡ºåºï¼‰ï¼Œä»¥ queue å’Œ deque ä¸ºä¾‹
    - æ„é€ ç”±å†…è€Œå¤–ï¼šå…ˆè°ƒç”¨ deque çš„ **é»˜è®¤æ„é€ å‡½æ•°**ï¼Œå†è°ƒç”¨ queue çš„æ„é€ å‡½æ•°ï¼ˆè¿™ä¸ªåº”è¯¥ä¸éš¾ç†è§£ï¼‰
    - ææ„ç”±å¤–è€Œå†…ï¼šå…ˆè°ƒç”¨ queue çš„ææ„å‡½æ•°ï¼Œå†è°ƒç”¨ deque çš„æ„é€ å‡½æ•°ï¼ˆæƒ³è±¡æˆå‰¥æ´‹è‘±ï¼Œå…ˆæ‹¿æ‰å¤–é¢çš„ç“£å†æ‹¿é‡Œé¢çš„ç“£ï¼‰
- **ç±»ä¹‹é—´çš„å¤åˆå…³ç³»ï¼Œå°±æ˜¯ä¸€ä¸ªç±»ä½œä¸ºå¦ä¸€ä¸ªç±»çš„â€œæˆå‘˜å˜é‡â€ï¼Œæ„æˆâ€œæ•´ä½“â€“éƒ¨åˆ†â€çš„ç»“æ„ï¼Œå¤åˆå¯¹è±¡éšå®¿ä¸»ç±»ä¸€èµ·åˆ›å»ºå’Œé”€æ¯ï¼Œç”Ÿå‘½å‘¨æœŸç»‘å®šåœ¨ä¸€èµ·ã€‚**

### 19.delegation å§”æ‰˜

- æ¦‚å¿µï¼šä¸€ä¸ªå¯¹è±¡ **å°†æŸä¸ªæ“ä½œçš„å®ç°å§”æ‰˜ç»™å¦ä¸€ä¸ªå¯¹è±¡æ¥å®Œæˆ**ï¼Œå³â€œåŠŸèƒ½ä»£ç†â€ã€‚
- å¦‚ä½•ç†è§£å§”æ‰˜ï¼šå³ **composition by referenceï¼Œ** ä¹Ÿæ˜¯ä¸€ä¸ªç±»ä¸­å«æœ‰å¦ä¸€ä¸ªç±»çš„ä¸œè¥¿ï¼Œåªä¸è¿‡å«æœ‰çš„ä¸æ˜¯å¦ä¸€ä¸ªç±»çš„å¯¹è±¡ï¼Œè€Œæ˜¯å¦ä¸€ä¸ªç±»çš„æŒ‡é’ˆ
- è¿™æ ·åšçš„æ„ä¹‰ï¼šä¸»ç±»ç»™å¤–ç•Œæä¾›æ¥å£ï¼Œè‡³äºä¸»ç±»çš„å‡½æ•°ï¼Œéƒ½æ˜¯å¦ä¸€ä¸ªç±»å®ç°çš„ï¼Œä¸»ç±»ä¸­åŒ…å«è¿™ä¸ªç±»çš„æŒ‡é’ˆæ¥è°ƒç”¨è‡ªå·±çš„å‡½æ•°ï¼Œ**æ¥å£ä¸å®ç°ä¸¥æ ¼åœ°åˆ†å¼€**

<img src="https://raw.githubusercontent.com/mumushu1/Pictures/main/5d811b776eb5846182c42f82be2c77ce.png" alt="image-20250515112828966" style="zoom:80%;" />	

- å¤åˆ VS å§”æ‰˜
    - **å¤åˆ** æ˜¯â€œæˆ‘æœ‰ä¸€ä¸ªä½ â€
    - **å§”æ‰˜** æ˜¯â€œæˆ‘è®©ä½ æ›¿æˆ‘åšè¿™äº‹â€

### 20.inheritance ç»§æ‰¿(is-a)

- æ¦‚å¿µï¼šå­ç±»ç»§æ‰¿çˆ¶ç±»çš„æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°
- å­ç±»å¯¹è±¡ä¸­æœ‰ä¸€éƒ¨åˆ†æ˜¯çˆ¶ç±»çš„ä¸œè¥¿ï¼ˆå¯ä»¥ç±»æ¯”æ•°æ®åº“ä¸­çš„å­ç±» - ç ”ç©¶ç”Ÿå’Œæœ¬ç§‘ç”Ÿçš„çˆ¶ç±»æ˜¯å­¦ç”Ÿï¼Œå®ƒä»¬éƒ½å…·æœ‰å­¦ç”Ÿçš„å±æ€§ï¼ŒåŠ ä¸Šä»–ä»¬è‡ªå·±ç‹¬æœ‰çš„å±æ€§ï¼‰
- ç»§æ‰¿å…³ç³»ä¸‹çš„æ„é€ å’Œææ„ï¼ˆç¼–è¯‘å™¨çš„æ‰§è¡Œé¡ºåºï¼‰
    - æ„é€ ï¼šç”±å†…ï¼ˆçˆ¶ç±»ï¼‰è€Œå¤–ï¼ˆå­ç±»ï¼‰
    - ææ„ï¼šç”±å¤–ï¼ˆå­ç±»ï¼‰è€Œå†…ï¼ˆçˆ¶ç±»ï¼‰
- è¿›ä¸€æ­¥å‰–æç»§æ‰¿å…³ç³»ä¸‹å­ç±»å’Œçˆ¶ç±»çš„æ„é€ å‡½æ•°
    - å¦‚æœçˆ¶ç±»ä½¿ç”¨é»˜è®¤æ„é€ ï¼Œåˆ™åœ¨å­ç±»çš„æ„é€ å‡½æ•°ä¸­è‡ªåŠ¨è°ƒç”¨çˆ¶ç±»çš„é»˜è®¤æ„é€ 
    - **å¦‚æœçˆ¶ç±»è‡ªå·±å†™äº†æ„é€ ï¼Œåˆ™åœ¨å­ç±»çš„æ„é€ å‡½æ•°ä¸­å¿…é¡»æ˜¾ç¤ºè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°**

```cpp
class Person {
public:
    Person(string i,string n) : id(i),name(n){}
    void print() const {
        cout << "I'm a person" << endl;
    }
    string res_id() const {
        return this->id;
    }
    string res_name() const {
        return this->name;
    }
protected:
    string id;
    string name;
};

class Student : public Person {
public:
    ****//çˆ¶ç±»ä¸ä½¿ç”¨é»˜è®¤æ„é€ ï¼Œåˆ™å­ç±»çš„æ„é€ å‡½æ•°åˆ—è¡¨éœ€è¦è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°
    Student(string id,string name,string school,int grade) : Person(id,name),school(school),grade(grade){}
    string res_school () const {
        return this->school;
    }
    int res_grade() const {
        return this->grade;
    }
private:
    string school;
    int grade;
};
int main() {
    Student s1("101","nap_latte","pku",500);
    cout << "å­¦ç”Ÿçš„å§“åï¼š" << s1.res_name() << endl;
    cout << "å­¦ç”Ÿçš„å­¦æ ¡ï¼š" << s1.res_school() << endl;
    cout << "å­¦ç”Ÿçš„æˆç»©ï¼š" << s1.res_grade() << endl;
//    å­¦ç”Ÿçš„å§“åï¼šnap_latte
//    å­¦ç”Ÿçš„å­¦æ ¡ï¼špku
//    å­¦ç”Ÿçš„æˆç»©ï¼š500
    return 0;
}
```

- ä¸‰ç§ç»§æ‰¿æ–¹å¼
  
  
    | ç»§æ‰¿æ–¹å¼ | çˆ¶ç±» public æˆå‘˜åœ¨å­ç±»ä¸­å˜æˆ | çˆ¶ç±» protected æˆå‘˜åœ¨å­ç±»ä¸­å˜æˆ | å˜åŒ– |
    | --- | --- | --- | --- |
    | public | public | protected | ä¸å˜ï¼ˆis-a çš„å…³ç³»ï¼‰ |
    | protected | protected | protected | å…¨å˜ä¸º protect |
    | private | private | private | å…¨å˜ä¸º private |

### 21.è™šå‡½æ•°

- virtual å‡½æ•°ï¼šå¸Œæœ›å­ç±»é‡å†™ï¼ˆoverrideï¼‰è¿™ä¸ªå‡½æ•°ï¼ˆè¿™ä¸ªå‡½æ•°åœ¨çˆ¶ç±»å·²æœ‰é»˜è®¤å®šä¹‰ï¼‰
- pure virtualï¼ˆçº¯è™šå‡½æ•°ï¼‰ï¼šå­ç±»å¿…é¡»é‡å†™è¿™ä¸ªå‡½æ•°ï¼ˆå‡½æ•°åœ¨çˆ¶ç±»ä¸­æ— é»˜è®¤å®šä¹‰ï¼‰
- æ™®é€šå‡½æ•°ï¼šä¸å¸Œæœ›å­ç±»é‡å†™çš„å‡½æ•°
- æŠ½è±¡ç±»ï¼šåŒ…å«çº¯è™šå‡½æ•°çš„ç±»ï¼Œæ¯”å¦‚ä¸‹é¢çš„ Shape ç±»ï¼ŒæŠ½è±¡ç±»åªèƒ½è¢«ç»§æ‰¿å’Œå®ç°ï¼Œä¸èƒ½åˆ›å»ºå¯¹è±¡ï¼ˆå®ä¾‹åŒ–ï¼‰

```cpp
class Shape {
public:
    virtual void draw() const = 0;//çº¯è™šå‡½æ•°è¯­æ³•ï¼šå‡½æ•° = 0
    virtual void error(const string& msg){//è™šå‡½æ•°
        cout << msg << endl;
    }
};

class Rectangle : public Shape {
public:
    void draw() const override {
        cout << "Rectangle draw!" << endl;
    }
};
class circle : public Shape {
public:
    void draw() const override {
        cout << "circle draw!" << endl;
    }
};
int main() {
    Rectangle re;
    circle ci;
    re.draw();
    ci.draw();
    re.error("default error!");
//    Rectangle draw!
//    circle draw!
//    default error!
    return 0;
}
```

- è®¾è®¡æ¨¡å¼ä¹‹ **Template Method**ï¼ˆæ¨¡ç‰ˆæ–¹æ³•ï¼‰
    - **åœ¨çˆ¶ç±»ä¸­å®šä¹‰ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†å…¶ä¸­çš„æŸäº›å…·ä½“æ­¥éª¤æ¨è¿Ÿåˆ°å­ç±»å®ç°**ï¼ˆå­ç±»é€šè¿‡é‡å†™çˆ¶ç±»çš„è™šå‡½æ•°ï¼‰
    - æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬éœ€è¦å®Œæˆæ‰“å¼€æ–‡ä»¶è¿™ä¸ªç®—æ³•ï¼Œè¿™äº›ç®—æ³•ä¸­æœ‰ä¸€äº›é€šç”¨æ­¥éª¤ï¼Œæ¯”å¦‚è¯´æ£€æµ‹è·¯å¾„åã€æ–‡ä»¶åç­‰ç­‰ï¼Œä½†ä¹Ÿæœ‰äº›ç‰¹æ®Šæ­¥éª¤ï¼Œæ¯”å¦‚é’ˆå¯¹æ–‡ä»¶æ ¼å¼ä¼šæœ‰ä¸åŒçš„å¤„ç†æ–¹æ³•ï¼Œæˆ‘ä»¬å°†å®ç°è¿™ä¸ªæ–¹æ³•çš„å‡½æ•°å‘½åä¸º Serializeï¼Œåœ¨çˆ¶ç±»å°†å…¶å£°æ˜ä¸ºè™šå‡½æ•°ï¼Œåœ¨å­ç±»ä¸­å†é‡å†™å®ç°å…·ä½“æ­¥éª¤
    - ä¸‹é¢ main()å‡½æ•°çš„æ‰§è¡Œæ­¥éª¤
        1. å­ç±»å¯¹è±¡è°ƒç”¨çˆ¶ç±»çš„ onFileOpen()å‡½æ•°
        2. æ‰§è¡Œçˆ¶ç±»çš„ onFileOpen()å‡½æ•°ï¼Œæ‰§è¡Œåˆ° Serialize()æ—¶ï¼Œè·³è½¬åˆ°å­ç±»å¯¹è¿™ä¸ªè™šå‡½æ•°çš„å®ç°
        3. æ‰§è¡Œå­ç±» override çš„ Serialize()åå›åˆ°çˆ¶ç±»ï¼Œæ‰§è¡Œå®Œå‰©ä½™çš„ onFileOpen()å‡½æ•°åè¿”å›åˆ° main()

<img src="https://raw.githubusercontent.com/mumushu1/Pictures/main/9a0f11a9b01bfd6b7c471dd8de1f205d.png" alt="image-20250515112857913" style="zoom:80%;" />	

- **å¤åˆå…³ç³» + ç»§æ‰¿å…³ç³»ä¸‹ï¼Œç¼–è¯‘å™¨æ‰§è¡Œæ„é€ å‡½æ•°çš„é¡ºåº**ï¼šâ‘  çˆ¶ç±»æ„é€ å‡½æ•° â‘¡ å­ç±»åŒ…å«çš„ç±»çš„æ„é€ å‡½æ•° â‘¢ å­ç±»æ„é€ å‡½æ•°

```cpp
class Shape {
public:
    Shape() {
        cout << "Shapeï¼ˆçˆ¶ç±»ï¼‰çš„æ„é€ å‡½æ•°æ‰§è¡Œäº†" << endl;
    }
};
class special_rectangle {
public:
    special_rectangle() {
        cout << "special_rectangleï¼ˆå­ç±»å¤åˆå…³ç³»åŒ…å«çš„ç±»ï¼‰çš„æ„é€ å‡½æ•°æ‰§è¡Œäº†" << endl;
    }
};

class Rectangle : public Shape {
public:
    special_rectangle sr;
    Rectangle() {
        cout << "Rectangleï¼ˆå­ç±»ï¼‰çš„æ„é€ å‡½æ•°æ‰§è¡Œäº†" << endl;
    }
};

Rectangle re;//å­ç±»å®ä¾‹åŒ–
```

<img src="https://raw.githubusercontent.com/mumushu1/Pictures/main/3e254ef4290246fe80ddbd5de54d2a11.png" alt="image-20250515112922558" style="zoom:80%;" />	

- ææ„æ¬¡åºåˆ™å®Œå…¨ç›¸å

### 22.è§‚å¯Ÿè€…æ¨¡å¼

- ç±»ä¼¼äº Notion ä¸­æ•°æ®åº“çš„ä¸åŒè§†å›¾ï¼Œæœ‰è¡¨æ ¼è§†å›¾ï¼Œæ—¥å†è§†å›¾ï¼ŒçŠ¶æ€æ è§†å›¾ç­‰ç­‰
- å½“ä¸€ä¸ªå¯¹è±¡(Subject)çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå…¶ä»–æ‰€æœ‰ä¾èµ–è€…(Observer çš„å­ç±»)éƒ½ä¼šæ”¶åˆ°é€šçŸ¥å¹¶è‡ªåŠ¨æ›´æ–°
- `Observer` æ˜¯ä¸€ä¸ªæŠ½è±¡åŸºç±»ï¼Œå®šä¹‰äº†ç»Ÿä¸€çš„æ¥å£ `update()`ï¼Œä¸åŒå­ç±»ç»§æ‰¿ Observer å¹¶é‡å†™ update()å®ç°ä¸åŒè§†å›¾çš„æ›´æ–°
- Subject æ›´æ–°åï¼Œéœ€è¦è®©æ‰€æœ‰è§‚å¯Ÿè€…çš„æ•°æ®ä¹Ÿæ›´æ–°ï¼Œä½†ä¸åŒè§‚å¯Ÿè€…æ›´æ–°æ•°æ®çš„æ–¹å¼å¯èƒ½ä¸åŒï¼Œå› æ­¤ Subject ä¸­è®¾ç½®äº† Observe *ç±»å‹çš„æŒ‡é’ˆï¼Œå°† update çš„ä»»åŠ¡* *å§”æ‰˜**ç»™ Observer

```cpp
class Observer;

class Subject {
    int m_value;
    vector<Observer*> m_views;
public:
    //æ·»åŠ æ–°è§†å›¾
    void attach(Observer *obs) {
        m_views.push_back(obs);
    }
    //è®¾ç½® Subject çš„æ–°å€¼ï¼Œå¹¶è‡ªåŠ¨é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…
    void set_val(int value) {
        m_value = value;
        notify();
    }
    //éå†æ‰€æœ‰è§‚å¯Ÿè€…ï¼Œè°ƒç”¨å®ƒä»¬çš„ update() æ¥å£ï¼Œå°† subject å¯¹è±¡å’Œ m_value çš„å€¼ä¼ ç»™è§‚å¯Ÿè€…
    void notify();
};

class Observer {
public:
    virtual void update(Subject* sub,int value) = 0;//æ¯ä¸ªè§‚å¯Ÿè€…éƒ½æœ‰è‡ªå·±çš„æ›´æ–°æ–¹å¼ï¼Œå› æ­¤è®¾ç½®ä¸ºè™šå‡½æ•°
};

inline void Subject::notify() {
    for (int i = 0; i < m_views.size(); i++)
        m_views[i]->update(this, m_value);
}
```

- ä»¥ Notion ä¸­æ•°æ®åº“çš„ä¸åŒè§†å›¾å¤§æ¦‚ä¸¾ä¸€ä¸ªä¾‹å­

```cpp
//è¢«è§‚å¯Ÿè€…ï¼Œç›¸å½“äºä¸Šé¢çš„ subject
class Database {
	vector<Observer*> m_views;
}

class Observer {}//è§‚å¯Ÿè€…çš„çˆ¶ç±»

class Table : public Observer{}//è¡¨æ ¼è§†å›¾
class Calendar : public Observer{}//æ—¥å†è§†å›¾
class StatusBar : public Observer{}//çŠ¶æ€æ è§†å›¾
```

### 23.ç»„åˆæ¨¡å¼

- å¯ä»¥è®©â€œç»„åˆå¯¹è±¡â€å’Œâ€œå•ä¸ªå¯¹è±¡â€å…·æœ‰ **ä¸€è‡´æ¥å£** è¿›è¡Œæ“ä½œï¼Œå³å¯ä»¥åƒå¤„ç†å•ä¸ªå¯¹è±¡ä¸€æ ·ï¼Œç»Ÿä¸€å¤„ç†å¤æ‚çš„ç»„åˆç»“æ„
    - ç»„åˆå¯¹è±¡ï¼šç±»ä¼¼æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶å¤¹
    - å•ä¸ªå¯¹è±¡ï¼šç±»ä¼¼æ–‡ä»¶ç³»ç»Ÿä¸­çš„å•ä¸ªæ–‡ä»¶

```cpp
class Component {
    int value;
public:
    Component(int val) {value = val;}
    virtual void add(Component*){}
};

//ç»„åˆå¯¹è±¡ - ç±»ä¼¼æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶å¤¹
class Composite : public Component{
    vector<Component*> c;
public:
    Composite(int val) : Component(val){}
    void add(Component* elem) {//æ–‡ä»¶å¤¹ä¸­å¯ä»¥åŠ å…¥æ–‡ä»¶
        c.push_back(elem);
    }
};

//å¶å­ç»“ç‚¹ - ç±»ä¼¼æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶
class Primitive : public Component {
public:
    Primitive(int val) : Component(val) {}
};

```

### 24.è½¬æ¢å‡½æ•°

- è½¬æ¢å‡½æ•°æ˜¯ä¸€ç§ç‰¹æ®Šçš„æˆå‘˜å‡½æ•°ï¼Œç”¨äºå°†ä¸€ä¸ª **ç±»çš„å¯¹è±¡è½¬æ¢ä¸ºå…¶ä»–ï¼ˆä½ è®¤ä¸ºåˆç†çš„ï¼‰ç±»å‹**
  - æ¯”å¦‚ä¸€ä¸ªåˆ†æ•° classï¼Œå¯ä»¥æƒ³åˆ°å°†å…¶è½¬åŒ–ä¸º double ç±»å‹
  - ä¹Ÿå¯ä»¥å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œåªè¦ä½ è®¤ä¸ºè¿™ä¹ˆåšåˆç†å³å¯
- è¿™æ ·çš„å¥½å¤„å°±æ˜¯å¯ä»¥è®© **è‡ªå®šä¹‰çš„ç±»å¯¹è±¡åƒå†…ç½®æ•°æ®ç±»å‹ä¸€æ ·ä½¿ç”¨**
- æ ¼å¼ï¼š**å…³é”®å­— operator åç›´æ¥è·Ÿè½¬æ¢ç±»å‹ï¼Œç›¸å½“äºè½¬æ¢ç±»å‹ä½œä¸ºå‡½æ•°åï¼Œå› ä¸ºå‡½æ•°åæœ¬èº«å°±æ˜¯è¿”å›ç±»å‹ï¼Œå› æ­¤å‡½æ•°ä¸éœ€è¦å£°æ˜è¿”å›ç±»å‹**
- ä¸€èˆ¬éœ€è¦å£°æ˜ä¸º constï¼Œä¸ä¼šä¿®æ”¹å½“å‰å¯¹è±¡

```cpp
class Fraction {
public:
    Fraction(int n,int d) : numerator(n),denominator(d){}
    operator double() const {
        return (double)numerator / denominator;
    }
    
private:
    int numerator; //åˆ†å­
    int denominator;//åˆ†æ¯
};

int main (){
    Fraction f(1,2);
    double res = 3 + f;
    cout << res << endl;//3.5
    return 0;
}
```

- ç¨‹åºæ‰§è¡Œ **`double res = 3 + f`** çš„è¿‡ç¨‹
  - å› ä¸ºæ‰§è¡Œçš„æ˜¯ int å‹ + ç±»çš„å¯¹è±¡ï¼ŒC++æœ¬èº«æ— æ³•æä¾›è¿™ç§åŠ æ³•ï¼Œæ‰€ä»¥è¿›è¡Œä»¥ä¸‹æ“ä½œ
  - é¦–å…ˆçœ‹æ˜¯å¦æœ‰å…³äº **â‘  è¿ç®—ç¬¦+çš„é‡è½½**ï¼Œæ‰¾æ˜¯å¦æœ‰ `double operator + (Fraction f,double d){}`
  - æ²¡æ‰¾åˆ°åå†å»çœ‹ç±»æˆå‘˜å‡½æ•°ä¸­æ˜¯å¦æœ‰ **â‘¡ è½¬æ¢å‡½æ•°**ï¼Œå³æ˜¯å¦å¯ä»¥å°†ç±»å¯¹è±¡è½¬æ¢ä¸ºå…¶ä»–ç±»å‹

### 25.éæ˜¾ç¤ºå•å‚æ•°æ„é€ å‡½æ•°

- å¦‚æœæƒ³å®ç° `Fraction res = f + 3`ï¼Œå³ä¸€ä¸ªåˆ†æ•°ç±»å¯¹è±¡ + æ•´æ•°ï¼Œè¿”å›åˆ†æ•°ç±»å¯¹è±¡ï¼Œç¼–è¯‘å™¨åœ¨æ‰§è¡Œæ—¶ï¼Œæ‰§è¡Œé¡ºåºå¦‚ä¸‹
  - é¦–å…ˆæ‰¾æ˜¯å¦æœ‰åˆ†æ•°ç±»å¯¹è±¡+æ•´æ•°çš„é‡è½½ - æ²¡æ‰¾åˆ°
  - å…¶æ¬¡å°è¯•æ˜¯å¦å¯å°†**å³æ“ä½œæ•°**(3)è½¬æ¢ä¸ºåˆ†æ•° - æ‰¾åˆ°éæ˜¾ç¤ºå•å‚æ•°æ„é€ 
- ç¼–è¯‘å™¨ä¼š ==ä¼˜å…ˆä¿è¯å·¦æ“ä½œæ•°çš„ç±»å‹ä¸å˜==ï¼Œæ‰€ä»¥ä¸ä¼šå…ˆè€ƒè™‘å»æ‰¾è½¬æ¢å‡½æ•°å°†å·¦æ“ä½œæ•° f è½¬ä¸º int

```c++
class Fraction {
public:
    Fraction(int n,int d = 1) : numerawtor(n),denominator(d){}
    //åŠ æ³•é‡è½½
    Fraction operator + (const Fraction& f) {
        //å®ç°ä¸¤ä¸ªåˆ†æ•°ç›¸åŠ çš„åŠ¨ä½œï¼Œä¸‹é¢å®ç°è¿‡ç¨‹ä¸é‡è¦
        Fraction res = Fraction(1);
        return res;
    }
private:
    int numerawtor;
    int denominator;
};

int main() {
    Fraction f(1,2); // 1/2
    Fraction res = f + 3;
    return 0;
}
```

- ä½†å¦‚æœï¼ˆéæ˜¾ç¤ºå•å‚æ•°æ„é€ +åŠ æ³•é‡è½½ï¼‰å’Œï¼ˆè½¬æ¢å‡½æ•°ï¼‰å¹¶å­˜ï¼Œæ­¤æ—¶æ‰§è¡Œ `Fraction res = 3 + f`ï¼Œå°±ä¼šæŠ¥é”™
  - å‰è€…æ˜¯å°†æ•´æ•°-> åˆ†æ•°ç±»å¯¹è±¡ï¼Œåè€…å°†åˆ†æ•°ç±»å¯¹è±¡-> doubleï¼Œç†è®ºä¸Šéƒ½å¯å®Œæˆ 3+f çš„æ“ä½œ
  - ç¼–è¯‘å™¨é¢å¯¹å¤šç§å¯è¡Œæ–¹æ¡ˆæ—¶ï¼Œå°±ä¼šæŠ¥é”™ï¼ˆè¿™ç‚¹å¾ˆæ¨¡ç³Šå¾ˆéš¾ï¼Œå…ˆæ”¾ä¸€ä¸‹ï¼‰

```c++
//åŠ æ³•é‡è½½
Fraction operator + (const Fraction& f) {
    //å®ç°ä¸¤ä¸ªåˆ†æ•°ç›¸åŠ çš„åŠ¨ä½œï¼Œä¸‹é¢å®ç°è¿‡ç¨‹ä¸é‡è¦
    Fraction res = Fraction(1);
    return res;
}
//è½¬æ¢å‡½æ•°
operator double() const {
    return (double) numerawtor / denominator;
}
```

- å¦‚æœç»™æ„é€ å‡½æ•°åŠ ä¸Šå…³é”®å­— `explicit`ï¼Œè¡¨ç¤ºä¸å…è®¸æ„é€ å‡½æ•°è‡ªåŠ¨æ‰§è¡Œåƒåˆšåˆšä¸€æ · 3 è½¬æ¢ä¸º $\frac{3}{1}$ çš„æ“ä½œ

```c++
//æ˜¾ç¤ºå•å‚æ•°æ„é€ å‡½æ•°
explicit  Fraction(int n,int d = 1) : numerawtor(n),denominator(d){}
```

### 26.pointer like classes åƒæŒ‡é’ˆä¸€æ ·çš„ç±»(å¯¹è±¡)

- ==æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªç±»ï¼Œä½†ç±»é‡Œé¢ä¼šæœ‰ä¸€ä¸ªçœŸæ­£çš„æŒ‡é’ˆ==

<img src="https://raw.githubusercontent.com/mumushu1/Pictures/main/7222a7089d8c60698acd7e8a9001f3be.png" alt="image-20250523094705779" style="zoom:80%;" />

- å…³äº **æ™ºèƒ½æŒ‡é’ˆ**ï¼Œæœ¬è´¨æ˜¯ **â€è‡ªåŠ¨ç®¡ç†èµ„æºçš„ç±»â€œ**ï¼Œæ ‡å‡†åº“çš„æ™ºèƒ½æŒ‡é’ˆéƒ½æ˜¯ä¸€ä¸ªä¸ª **ç±»æ¨¡æ¿**ï¼Œæ˜¯ **å°è£…äº†åŸå§‹æŒ‡é’ˆå¹¶é‡è½½æ“ä½œç¬¦çš„ç±»æ¨¡æ¿**
  - ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œ`T* px` æ˜¯ç±»ä¸­çœŸæ­£çš„æŒ‡é’ˆ
  - `share_ptr<Foo> sp (new Foo)`
    - `(new Foo)` å³è°ƒç”¨ç±»æ„é€ å‡½æ•°ï¼Œè¡¨ç¤º Foo ç±»å‹å¯¹è±¡çš„æŒ‡é’ˆèµ‹äºˆä¸ºæŒ‡é’ˆ px
    - åˆ›å»ºç±»çš„å¯¹è±¡ spï¼ŒæŒ‡å®š T ä¸º Foo ç»“æ„ä½“ç±»å‹ï¼Œå³å¯¹è±¡çš„ px æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ª Foo ç±»å‹çš„ç»“æ„ä½“
  - `Foo f(*sp)`
    - `*sp` æ˜¯è°ƒç”¨ç±»ä¸­å¯¹ *çš„é‡è½½ï¼Œè¿”å›å½“å‰å¯¹è±¡çš„* px æŒ‡é’ˆï¼Œè€Œ px åœ¨ä¸Šæ–‡æåˆ°æ˜¯ä¸€ä¸ªæŒ‡å‘ Foo ç»“æ„ä½“ç±»å‹çš„æŒ‡é’ˆï¼Œ *px å°±æ˜¯æŒ‡å‘çš„ç»“æ„ä½“
    - æ‰€ä»¥ `Foo f(*sp)` ç›¸å½“äºæ˜¯è¿›è¡Œäº†ä¸€æ­¥ **æ‹·è´æ„é€ **ï¼Œåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ç»“æ„ä½“å¯¹è±¡ fï¼Œf çš„â€œå€¼â€å°±æ˜¯*sp æŒ‡å‘çš„ç»“æ„ä½“
  - `sp->method()`
    - sp æ˜¯ç±»å¯¹è±¡ï¼Œsp-> method()å°±æ˜¯ç±»å¯¹è±¡è°ƒç”¨ç±»æˆå‘˜å‡½æ•°
    - åªä¸è¿‡åœ¨ç±»ä¸­å¯¹ `->` åšäº†é‡è½½ï¼Œä¼šè¿”å› px æŒ‡é’ˆï¼Œè€Œ `->` ä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œ ==ï¼ˆæ“ä½œç¬¦çš„é“¾å¼è°ƒç”¨ï¼‰==ï¼Œå³ç›¸å½“äºæ‰§è¡Œ `px->method()`
    - è€Œ px æ˜¯æŒ‡å‘ Foo ç»“æ„ä½“çš„æŒ‡é’ˆï¼Œå½“ç„¶å¯ä»¥è°ƒç”¨ method()

```cpp
template<class T>
    
class share_ptr {
public:
    T& operator *() const{
        return *px;
    }
    T* operator ->() const {
        return px;
    }
    share_ptr(T* p) : px(p) {}

private:
    T* px;
    long* pn;
};
struct Foo {
    void method() {
		cout << "methodå·²è¢«è°ƒç”¨" << endl;
    }
};
int main() {
    share_ptr<Foo> sp (new Foo);
    Foo f(*sp);

    sp->method();

    return 0;
}
```

- å…³äº **è¿­ä»£å™¨**

  - ä¸‹é¢æ˜¯ä¸€ä¸ªè¿­ä»£å™¨çš„ç®€å•ç”¨æ³•

  ```cpp
  list<int> p = {1,2,3,4,5};
  for (list<int>::iterator it = p.begin(); it != p.end(); it++) {
      cout << *it << " " ;
  }
  ```

  - è¿­ä»£å™¨ä¹Ÿå’Œä¸Šé¢ä¸€æ ·ï¼Œéƒ½åœ¨ç±»ä¸­åšäº†æ“ä½œç¬¦é‡è½½ï¼Œåœ¨*it æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›ç›´æ¥å–åˆ°å®¹å™¨ä¸­çš„ dataï¼Œè€Œä¸æ˜¯ next æˆ– prior æŒ‡é’ˆ
  - `return &(operator *());`
    - operator *()è°ƒç”¨ä¸Šé¢çš„*()å‡½æ•°ï¼Œå³è¿”å› data çš„å¼•ç”¨
    - &(operator *())ï¼šå– data çš„å¼•ç”¨çš„åœ°å€ï¼Œ* *ä¼šå¾—åˆ°å®é™… data çš„åœ°å€**ï¼Œå› ä¸ºå¼•ç”¨æ²¡æœ‰ç‹¬ç«‹çš„åœ°å€
    - æ‰€ä»¥è¿”å›çš„æŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆå°±æ˜¯æŒ‡å‘ data

  ```CPP
  //é€šè¿‡è¿­ä»£å™¨è·å–å½“å‰èŠ‚ç‚¹çš„å€¼
  reference operator *() const {
      return (*node).data;
  }
  
  //è¿”å›æŒ‡å‘å½“å‰dataçš„æŒ‡é’ˆ
  pointer operator ->() const {
      return &(operator *());
  }
  ```

### 27.function like class åƒå‡½æ•°ä¸€æ ·çš„ç±» ï¼ˆä»¿å‡½æ•°ï¼‰

- ä»¿å‡½æ•°æœ¬è´¨ä¸Šæ˜¯ **é‡è½½äº†()çš„ç±» or ç»“æ„ä½“**ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰ä»¿å‡½æ•°ï¼Œè¿™ä¸ªä»¥åå†è¯´ï¼Œå…ˆå…³æ³¨è¯­æ³•å±‚é¢

- ä¸€ä¸ªå°ä¾‹å­ï¼šè°ƒç”¨ä»¿å‡½æ•°æ—¶ï¼Œç›´æ¥`å¯¹è±¡+()å³å¯`

```cpp
template<typename T>

class Add {
public:
    T operator () (T a,T b) {
        return a + b;
    }
};
int main() {
    Add<int> add_int;
    cout << add_int(3,4);

    Add<float> add_float;
    cout << add_float(2.2,4.2);

    return 0;
}
```

### 28.æ¨¡æ¿

#### â‘  ç±»æ¨¡æ¿&å‡½æ•°æ¨¡æ¿

- ç±»æ¨¡æ¿ï¼šç±»çš„æˆå‘˜å˜é‡å¯ä»¥æœ‰ä¸åŒçš„ç±»å‹
- å‡½æ•°æ¨¡æ¿ï¼šä¸€ä¸ªæ¨¡æ¿å‡½æ•°ï¼Œå‡½æ•°çš„å‚æ•°å¯ä»¥æœ‰å¾ˆå¤šç±»å‹ï¼Œä½†ä¸€æ¬¡è°ƒç”¨æ—¶ï¼Œåªèƒ½æŒ‡å®šä¸€ç§ç±»å‹ï¼Œæ¯”å¦‚æœ¬ä¾‹ä¸­çš„ min1 å‡½æ•°ï¼Œåªèƒ½ä¸¤ä¸ª int æ¯”æˆ–ä¸¤ä¸ª double æ¯”ï¼Œä¸èƒ½ int å’Œ double æ¯”ï¼Œè¿™æ · **æ¨¡ç‰ˆæ¨å¯¼ä¼šå¤±è´¥**
  - å¦‚æœéœ€è¦ä¸¤ä¸ªä¸åŒç±»å‹çš„å‚æ•°ï¼Œå¼‚æˆ–æ˜¯æ›´å¤šï¼Œéœ€è¦å†™æˆä¸¤ä¸ªæˆ–å¤šä¸ªæ¨¡æ¿å‚æ•° `template <typename T1, typename T2>`

- **class VS typename**
  - C++ä¸­ `class` å’Œ `typename` åœ¨æ¨¡æ¿å‚æ•°åˆ—è¡¨ä¸­ï¼Œ**å®Œå…¨ç­‰ä»·**ï¼Œ`template<class T>` å’Œ `template<typename T>` æ˜¯ä¸€æ ·çš„
  - **é™¤äº†** åœ¨æ¨¡æ¿å†…éƒ¨çš„ **åµŒå¥—ä¾èµ–ç±»å‹ä¸­**ï¼Œå¿…é¡»ä½¿ç”¨ `typename`ï¼Œè¿™éƒ¨åˆ†ä»¥åå†èŠï¼Œç°é˜¶æ®µçŸ¥é“äºŒè€…å¤§å¤šæƒ…å†µæ— åŒºåˆ«


```cpp
template<typename T>

class Stone {
private:
    T weight;
    T height;
public:
    Stone(int w,int h) : weight(w),height(h){}

    bool operator < (const Stone &sother) const{
        return this->height < sother.height;
    }

    T get_height() const{
        return this->height;
    }
};

template<typename T>
inline const T& min1(const T& a,const T& b) {
    return b < a ? b : a;
}

int main() {
    Stone<int> s1(1,3);
    Stone<int> s2(1,4);
    //æ¨¡æ¿å‡½æ•°è¦æ±‚ä¸¤ä¸ªå‚æ•°ç±»å‹ä¸€æ ·
    auto more_min = min1(s1,s2);
    cout << more_min.get_height();
    return 0;
}
```

- ç±»æ¨¡æ¿å’Œå‡½æ•°æ¨¡æ¿æ€»ç»“
  - ç±»æ¨¡æ¿ç”¨äºå†™ **é€šç”¨çš„æ•°æ®ç»“æ„ç±»ï¼Œ** å‡½æ•°æ¨¡æ¿ç”¨äºå†™ **é€šç”¨ç®—æ³•å‡½æ•°**
  - ç±»æ¨¡æ¿åœ¨åˆ›å»ºå¯¹è±¡æ—¶å¿…é¡» **æŒ‡å®š** ç±»å‹ï¼Œå‡½æ•°æ¨¡æ¿åœ¨è°ƒç”¨æ—¶ **è‡ªåŠ¨æ¨å¯¼ç±»å‹**

#### â‘¢ æˆå‘˜æ¨¡æ¿

> è¿™é‡Œç›¸å½“æ¨¡ç³Šï¼Œç­‰ä¹‹åæ·±é€ å§

- å®šä¹‰ï¼š**ä¸€ä¸ªç±»ï¼ˆæˆ–ç»“æ„ä½“ï¼‰ä¸­çš„æˆå‘˜å‡½æ•°æ˜¯æ¨¡æ¿å‡½æ•°**
- ä¸‹é¢çš„ä»£ç ï¼šå…ˆå¸¸åˆ›å»º <iPhone,MacBook> ç±»å‹çš„ pair å¯¹è±¡ Appleï¼Œä¹‹åä½¿ç”¨ Apple åˆ›å»ºäº† baseComboï¼Œè¿™ä¸ª baseComboï¼Œç±»å‹æ˜¯ <Phone,Laptop> ä½†å…¶å€¼è¿˜æ˜¯ Apple çš„å€¼ï¼Œå³ **å†…å®¹æ˜¯å­ç±»ï¼Œç±»å‹æ˜¯çˆ¶ç±»**
- è¿™æ ·çš„ä½œç”¨ï¼šæ”¯æŒä¸åŒç±»å‹å¯¹è±¡ä¹‹é—´çš„æ‹·è´ï¼ˆåªè¦ä»–ä»¬çš„ç±»å‹å¯ä»¥è½¬æ¢ï¼šå­ç±»å¯è½¬æ¢ä¸ºçˆ¶ç±»ï¼Œä½†çˆ¶ç±»ä¸èƒ½è½¬æ¢ä¸ºå­ç±»ï¼‰ï¼Œ**å¯ä»¥ç”¨ç±»å‹ä¸åŒçš„å¯¹è±¡å»æ„é€ å¦ä¸€ä¸ªæ¨¡æ¿å¯¹è±¡ï¼Œåªè¦ä»–ä»¬ç±»å‹å¯ä»¥è½¬æ¢**

```cpp
class Phone {
public:
    void call() const {cout << "Calling" << endl;}
};

class Laptop {
public:
    void code() const {cout << "Coding" << endl;}
};

template <typename T1,typename T2>
struct Combo {
    T1 item1;
    T2 item2;
    Combo(){}//é»˜è®¤æ„é€ 
    //æˆå‘˜æ¨¡ç‰ˆæ„é€ 
    template <typename U1,typename U2>
    Combo(const Combo<U1,U2>& other) : item1(other.item1),item2(other.item2){}
};

class iPhone : public Phone {};
class MacBook : public Laptop {};

int main() {
    Combo<iPhone,MacBook> Apple;//ä¸€ä¸ªå…³äºè‹¹æœå…¬å¸çš„æ‰‹æœº+ç¬”è®°æœ¬äº§å“ç»„åˆ
    Combo<Phone,Laptop> baseCombo(Apple);//ç”¨â€œè‹¹æœç»„åˆâ€æ„é€ å‡ºåŸºç¡€ç»„åˆï¼ˆæ‰‹æœº+ç¬”è®°æœ¬ç»„åˆï¼‰
    //basepackçš„ç±»å‹æ˜¯<Phone,Lapop>ç±»å‹ï¼Œä½†æ˜¯basepackçš„å€¼è¿˜æ˜¯iPhoneå’ŒMacBookçš„å€¼ç›´æ¥æ‹·è´è¿‡æ¥çš„ï¼Œä¹Ÿå°±æ˜¯å†…å®¹æ˜¯å­ç±»ï¼Œä½†ç±»å‹æ˜¯çˆ¶ç±»ï¼
}
```

#### â‘£æ¨¡æ¿ç‰¹åŒ–

- æ˜¯ä»€ä¹ˆï¼šåœ¨ç¼–å†™æ³›å‹ä»£ç æ—¶ï¼Œæœ‰æ—¶æƒ³ä¸º**æŸäº›ç‰¹å®šç±»å‹å®šä¹‰ä¸ä¸€æ ·çš„å®ç°**ï¼Œå°±éœ€è¦ç”¨åˆ°æ¨¡æ¿ç‰¹åŒ–

```cpp
template<typename T>
struct MyPrint { //æ¨¡æ¿ç±» - æ³›åŒ–
    void print() {
        cout << "generic type" << endl;
    }
};
template<> //æ³¨æ„è¿™é‡Œæ²¡æœ‰å‚æ•°
struct MyPrint<int> { //ç‰¹åŒ–æ¨¡æ¿ï¼ˆåªé€‚ç”¨äºintï¼‰ - ç‰¹åŒ–
    void print() {
        cout << "int type" << endl;
    }
};

int main() {
    MyPrint<float> m1;
    MyPrint<int> m2;
    m1.print();//"generic type"
    m2.print();//"int type"
    return 0;
}
```

- å¥½å¤„ï¼šä¸ºæŸäº›ç±»å‹æä¾›æ›´é«˜æ•ˆçš„å®ç°ï¼›å¯¹ç‰¹å®šç±»å‹ç‰¹æ®Šå¤„ç†ï¼›é¿å…å†™å¤šä¸ªé‡å¤çš„ç±»/å‡½æ•°

#### â‘¤ æ¨¡æ¿åç‰¹åŒ–

- æ˜¯ä»€ä¹ˆï¼šåªå¯¹æ¨¡æ¿çš„ä¸€éƒ¨åˆ†å‚æ•°è¿›è¡Œç‰¹åŒ–ï¼Œ**ä¿ç•™å…¶ä»–å‚æ•°çš„æ³›å‹æ€§**ï¼Œä¸Šé¢çš„ç‰¹åŒ–æ˜¯å…¨ç‰¹åŒ–ï¼Œä¸ä¹‹å¯¹åº”å°±æ˜¯ç°åœ¨çš„åç‰¹åŒ–ï¼Œåç‰¹åŒ–æ˜¯ä»‹äºâ€œé€šç”¨æ¨¡æ¿â€å’Œâ€œå…¨ç‰¹åŒ–â€ä¹‹é—´çš„ä¸€ç§çµæ´»æ–¹æ¡ˆ
- ==ä¸ªæ•°ä¸Šçš„åç‰¹åŒ–==ï¼šå³å¤šä¸ªå‚æ•°æ—¶ï¼Œç‰¹åŒ–éƒ¨åˆ†å‚æ•°

```cpp
template<typename T1,typename T2> //æ³›å‹æ¨¡æ¿
struct Type {
    static void print() {
        cout << "general template" << endl;
    }
};

template<typename T> //ç¬¬ä¸€ä¸ªå‚æ•°ä»»æ„ç±»å‹ï¼ŒæŒ‡å®šç¬¬äºŒä¸ªå‚æ•°ä¸ºintç±»å‹
struct Type<T,int> {
    static void print() {
        cout << "åç‰¹åŒ–ï¼šç¬¬äºŒé¡¹ä¸ºintç±»å‹" << endl;
    }
};

int main() {
    Type<double,string> t1;
    Type<double,int> t2;
    t1.print();//"general template"
    t2.print();//"åç‰¹åŒ–ï¼šç¬¬äºŒé¡¹ä¸ºintç±»å‹"
    return 0;
}
```

- ==èŒƒå›´ä¸Šçš„åç‰¹åŒ–==ï¼šæ²¡æœ‰å…·ä½“æŒ‡å®šæŸä¸ªå‚æ•°ç‰¹åŒ–ï¼Œè€Œæ˜¯ç»™å‡ºä¸€ä¸ª**èŒƒå›´**ï¼Œæ¯”å¦‚å¯¹æŒ‡é’ˆç±»çš„æ‰€æœ‰ç±»å‹éƒ½åŒ¹é…è¿™ä¸ªç‰¹åŒ–æ¨¡æ¿

```cpp
//é€šç”¨ç‰ˆæœ¬
template<typename T>
struct C {
    void print() const{
        cout << "éæŒ‡é’ˆçš„è¾“å‡º" << endl;
    }
};

//åç‰¹åŒ–ç‰ˆæœ¬
template<typename U>
struct C<U*> {
    void print() const{
        cout << "æŒ‡é’ˆçš„è¾“å‡º" << endl;
    }
};

int main() {
    C<int> c1;
    C<int*> c2;
    c1.print();//éæŒ‡é’ˆçš„è¾“å‡º
    c2.print();//æŒ‡é’ˆçš„è¾“å‡º
    return 0;
}
```

#### â‘¥ æ¨¡æ¿æ¨¡æ¿å‚æ•°

- æ˜¯ä»€ä¹ˆï¼šä¸€ä¸ªæ¨¡æ¿çš„å‚æ•°åˆ—è¡¨ä¸­ï¼Œå…è®¸å°†å¦ä¸€ä¸ªæ¨¡æ¿å½“åšå‚æ•°ä¼ å…¥ï¼Œä¸‹é¢é€šè¿‡ä¸€ä¸ªä¾‹å­ç†è§£
- ä¸€ä¸ªå®¹å™¨æ¨¡æ¿

```cpp
template<typename T>
class Container {
public:
    void add(const T& x){}
    T get(int i) const {}
};
```

- ä¸‹é¢é’ˆå¯¹è¿™ä¸ªå®¹å™¨æ¨¡æ¿è®¾ç½®ä¸€ä¸ªç®¡ç†è€…æ¨¡æ¿ï¼Œå…¶æœ¬èº«ä¹Ÿæ˜¯ä¸ªæ¨¡æ¿ï¼Œéœ€è¦çš„å‚æ•°ä¸º
  - ä¸€ä¸ªæ¨¡æ¿å‚æ•°ï¼šå³éœ€è¦ç®¡ç†çš„å®¹å™¨æ¨¡æ¿ï¼Œæ¯”å¦‚`vector`,`list`
  - ä¸€ä¸ªç±»å‹æ¨¡æ¿ï¼šå®¹å™¨ä¸­å­˜æ”¾çš„å…ƒç´ ç±»å‹ï¼Œæ¯”å¦‚`int`,`stirng`
  - `template<template<typename> class C,typename T>`è¯­æ³•è®°ä¸€ä¸‹

```cpp
//å®¹å™¨æ¨¡æ¿Container
template<typename T>
class Container {
public:
    void add(const T& x){}
    T get(int i) const {}
};

//ç®¡ç†è€…æ¨¡æ¿Manger
template<template<typename> class C,typename T>// â€œC æ˜¯ä¸€ä¸ªæ¨¡æ¿ï¼Œå®ƒæœ¬èº«æ¥å—ä¸€ä¸ªç±»å‹å‚æ•°â€
class Manger {
    C<T> data;//ç”¨ä¼ å…¥çš„å®¹å™¨æ¨¡æ¿Cæ¥å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡
public:
    void add(const T& x) {data.add(x);}
    T get(int i)const {return data.get(i);}
};

int main() {
    Manger<Container,int> m1;//ç”¨è‡ªå®šä¹‰çš„Containerå­˜int
    Manger<vector,int> m2;//ç”¨vectorå­˜int
    Manger<list,int> m3;//ç”¨listå­˜int
}
```

### 29.å€¼ã€æŒ‡é’ˆå’Œå¼•ç”¨

#### â‘ æ¦‚å¿µåˆçª¥

```cpp
int x = 5;
int* p = &x;//&xæ˜¯å¯¹xå–åœ°å€
int& r = x;

cout << "p = " << p << endl;//p = 0x8b2cfff744
cout << "*p = " << *p << endl;//*p = 5
cout << "&p= " << &p << endl;//&p= 0x8b2cfff738
cout << "r = " << r << endl;//r = 5
```

- æŒ‡é’ˆä¹Ÿæ˜¯è€ç”Ÿå¸¸è°ˆäº†ï¼Œpæ˜¯æŒ‡é’ˆ ä¹Ÿæ˜¯ä¸ªåœ°å€ï¼Œ*på³pæŒ‡å‘çš„å€¼ï¼Œ&på³å¯¹æŒ‡é’ˆå–åœ°å€ï¼Œä¹Ÿå°±æ˜¯æŒ‡é’ˆçš„åœ°å€ï¼Œä¸‹é¢ä¸»è¦è°ˆä¸‹å¼•ç”¨
- æ³¨æ„`*`çš„ä¸åŒå«ä¹‰
  - `int* p`ï¼Œè¿™é‡Œçš„*å‡ºç°åœ¨å˜é‡å®šä¹‰ä¸­ï¼Œè¡¨ç¤ºpæ˜¯ä¸€ä¸ªæŒ‡å‘intç±»å‹çš„æŒ‡é’ˆ
  - `*p`ï¼Œå‡ºç°åœ¨è¡¨è¾¾å¼ä¸­æ—¶ï¼Œè¿™é‡Œçš„*è¡¨ç¤º**è§£å¼•ç”¨**

- **å®šä¹‰å¼•ç”¨æ—¶å¿…é¡»è¦è®¾åˆå€¼**ï¼Œä¸”è®¾å®Œä¹‹åå°±ä¸èƒ½ç»‘å®šåˆ°å…¶ä»–å¯¹è±¡ä¸Šäº†ï¼ˆå¯¹æ¯”æŒ‡é’ˆå¯ä»¥éšæ„æ¢äººç»‘å®šï¼‰
- å®šä¹‰æŒ‡é’ˆæ—¶ä¹Ÿéœ€è¦åˆå§‹åŒ–ï¼Œå¦åˆ™å®ƒä»¬å¯èƒ½åŒ…å«åƒåœ¾å€¼ï¼Œå¯¼è‡´æœªå®šä¹‰è¡Œä¸º

```cpp
int y = 3;
r = y;//è¿™é‡Œä¸æ˜¯è®©rç»‘å®šåˆ°yä¸Šï¼Œä¸Šé¢è¯´äº†å¼•ç”¨ä¸èƒ½æ¢äººï¼Œè¿™é‡Œç›¸å½“äºæ˜¯å°†yçš„å€¼èµ‹ç»™xâ­â­â­
cout << x;//å¯ä»¥çœ‹åˆ°xçš„å€¼å·²ç»å˜ä¸º3äº†ï¼Œè¿™é‡Œå¾ˆåƒå‡½æ•°çš„å‚æ•°ä¼ å…¥å¼•ç”¨ï¼Œæ”¹å¼•ç”¨å°±ç›¸å½“äºæ”¹å…¶ç»‘å®šçš„å¯¹è±¡
```

- å¼•ç”¨å’Œå€¼æ˜¯**ä¸€ä½“çš„ä¸¤é¢**ï¼Œä»¥ä¸Šé¢xå’Œrä¸ºä¾‹ï¼Œxçš„åœ°å€å’Œrçš„å¤§å°æ˜¯ä¸€æ ·çš„ï¼Œåœ°å€ä¹Ÿæ˜¯ä¸€æ ·çš„==ï¼ˆå…¨éƒ½æ˜¯å‡è±¡ï¼‰==

```cpp
cout << "&x = " << &x << endl;//xçš„åœ°å€ &x = 0x12c01ff66c
cout << "&r = " << &r << endl;//rçš„åœ°å€ &r = 0x12c01ff66c
```

- æŒ‡é’ˆã€å¼•ç”¨ã€æŒ‡é’ˆçš„å¼•ç”¨

```cpp
int x = 22;

int& r1 = x;//r1æ˜¯xçš„å¼•ç”¨ï¼Œå³r1å’Œxæ˜¯ä¸€ä¸ªä¸œè¥¿

int* p = &x;//pæ˜¯æŒ‡å‘xçš„æŒ‡é’ˆ

int*& r2 = p;//r2æ˜¯æŒ‡é’ˆpçš„å¼•ç”¨ï¼Œå³r2å’ŒæŒ‡é’ˆpæ˜¯ä¸€ä¸ªä¸œè¥¿
                                 â†“
cout << *r2 << endl;//è¾“å‡º22ï¼Œ*r2ç›¸å½“äº*p
```

- æŒ‡é’ˆæŒ‡å‘æ•°ç»„æ—¶ï¼Œåˆ™æŒ‡å‘æ•°ç»„é¦–å…ƒç´ ï¼Œä¸”æŒ‡é’ˆå¯ä»¥è¿›è¡Œ++ --çš„æ“ä½œ**ï¼ˆä»…é’ˆå¯¹æ•°ç»„æŒ‡é’ˆæ‰æœ‰è‡ªå¢è‡ªå‡çš„è¿ç®—ï¼‰**

```cpp
int arr[5] = {1,2,3,4,5};

int *p = arr;

cout << "p = " << p << endl;
cout << "*p = " << *p << endl;

p++;

cout << "p = " << p << endl;
cout << "*p = " << *p << endl;

//è¾“å‡º
p = 0x1ddebff9b0
*p = 1
p = 0x1ddebff9b4  å¯ä»¥çœ‹åˆ°åœ°å€åŠ äº†4Bï¼Œå³ä¸€ä¸ªintçš„å¤§å°
*p = 2
```

#### â‘¡å‡è±¡çš„ç”±æ¥

- **è¯­è¨€å±‚é¢çš„çœŸç›¸ï¼šå¼•ç”¨æ˜¯ä¸€ä¸ªåˆ«åï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¯¹è±¡**
  - å³ä¸å ç”¨æ–°çš„å­˜å‚¨ç©ºé—´ï¼Œæ‰€ä»¥ä¸Šé¢å¼•ç”¨å’Œå˜é‡çš„å¤§å°ä¸€æ ·ï¼Œåœ°å€ä¸€æ ·ï¼Œå¼•ç”¨rå°±æ˜¯xï¼Œxå°±æ˜¯r
  - ==æ‰€ä»¥å¯¹rçš„ä»»ä½•æ“ä½œéƒ½å°†ä½œç”¨åœ¨xä¸Š==
- **ç¼–è¯‘å™¨çš„å®ç°å±‚é¢ï¼šå¼•ç”¨é€šå¸¸è¡¨ç°ä¸ºå¸¸é‡æŒ‡é’ˆ**ï¼šæµ…è‰²ç®­å¤´ï¼Œæ‰€ä»¥å¼•ç”¨çš„å®é™…å¤§å°åº”è¯¥æ˜¯4ä¸ªå­—èŠ‚ï¼ˆ32ä½ç³»ç»Ÿä¸‹ï¼‰ï¼Œå’ŒæŒ‡é’ˆå¤§å°ä¸€è‡´

<img src="https://raw.githubusercontent.com/mumushu1/Pictures/main/651a8f4725abb46c4d0402f93631ddb3.png" alt="image-20250529101317956" style="zoom:80%;" />	

#### â‘¢å¼•ç”¨çš„å¸¸è§ç”¨é€”

- å‡½æ•°ä¼ å‚ï¼šæœ€å¥½æ˜¯ä¼ å¼•ç”¨æˆ–å¸¸é‡å¼•ç”¨ï¼Œå› ä¸ºé€Ÿåº¦æ›´å¿«
  - è§£é‡Šä¸€ä¸‹é€Ÿåº¦é—®é¢˜ï¼šåœ¨ä¸Šç¯‡è¯´è¿‡é€Ÿåº¦æ›´å¿«ï¼Œä½†ä¸Šæ–‡åˆæåˆ°å¼•ç”¨çš„å¤§å°å’Œåœ°å€ä¸å…¶ç»‘å®šçš„å¯¹è±¡æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¸ºä»€ä¹ˆæ›´å¿«
  - ä¸Šæ–‡æåˆ°å¤§å°å’Œåœ°å€ä¸€æ ·æ˜¯å‡è±¡äº†ï¼Œåœ¨ä¼ å‚æ—¶ï¼Œå¦‚æœä¼ å¼•ç”¨çš„è¯æœ¬è´¨ä¸Šæ˜¯ä¼ äº†ä¸€ä¸ªæŒ‡é’ˆï¼Œå¯¹æ¯”å¦‚æœæ˜¯ä¼ å€¼çš„è¯ï¼Œéœ€è¦å°†æ•´ä¸ªå€¼å‹æ ˆï¼ˆå€¼å¾ˆå¤§å°±å¾ˆå æ—¶ç©ºï¼‰ï¼Œè€ŒæŒ‡é’ˆçš„å¤§å°æ˜¯å›ºå®š4B(32ä½ç³»ç»Ÿä¸‹)
  - å¼•ç”¨ä¸€èˆ¬ä¸æ‹¿æ¥å£°æ˜å˜é‡orå®šä¹‰å¯¹è±¡ï¼Œä¸€èˆ¬å°±æ˜¯å‚æ•°ä¼ é€’çš„æ—¶å€™å»ç”¨
- è¿”å›ç±»å‹ï¼šèƒ½è¿”å›å¼•ç”¨å°±è¿”å›å¼•ç”¨

#### â‘£å‡½æ•°åç›¸åŒï¼Œä¼ å‚æ–¹å¼ä¸åŒçš„ä¸¤ä¸ªå‡½æ•°

- ä»¥ä¸‹ä¸¤ä¸ªå‡½æ•°æ˜¯ä¸èƒ½å¹¶å­˜çš„ï¼Œåœ¨è¯­æ³•å±‚é¢ä¸Šï¼Œå¼•ç”¨å°±æ˜¯å€¼çš„åˆ«å
  - åœ¨è°ƒç”¨funcæ—¶ï¼Œä¸ç®¡æ˜¯ä¼ å€¼è¿˜æ˜¯ä¼ å¼•ç”¨ï¼Œè°ƒç”¨æ–¹å¼éƒ½æ˜¯`func(a)`ï¼Œå¦‚æœäºŒè€…å¯ä»¥å¹¶å­˜ï¼Œè°ƒç”¨`func(a)`æ—¶ç¼–è¯‘å™¨æ— æ³•åˆ†æ¸…æ˜¯è°ƒç”¨çš„å“ªä¸ªå‡½æ•°

```cpp
void func(int a) {}
void func(int& a){}
```

- å¤ä¹ ä¸€ä¸‹constï¼Œç›¸åŒçš„ä¸¤ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªåŠ const ï¼Œ ä¸€ä¸ªä¸åŠ constï¼ŒäºŒè€…æ˜¯å¯ä»¥å¹¶å­˜çš„ 

```cpp
void func() const{}
void func() {}
```

#### â‘¤å·¦å€¼å¼•ç”¨å’Œå³å€¼å¼•ç”¨

- C++ä¸­ï¼Œå·¦å€¼å’Œå³å€¼æ˜¯è¡¨è¾¾å¼çš„ä¸¤ç§åŸºæœ¬åˆ†ç±»ï¼Œå®ƒä»¬å†³å®šäº†è¡¨è¾¾å¼çš„ç»“æœåœ¨å†…å­˜ä¸­çš„ä½ç½®å’ŒçŠ¶æ€
  - å·¦å€¼ï¼šå…·æœ‰**æŒä¹…çŠ¶æ€**çš„å¯¹è±¡ï¼Œæœ‰æ˜ç¡®çš„å†…å­˜åœ°å€ï¼Œå¯ä»¥å¤šæ¬¡è¢«èµ‹å€¼
  - å³å€¼ï¼š**ä¸´æ—¶çš„ï¼Œæ²¡æœ‰æŒä¹…çŠ¶æ€çš„å€¼**ï¼Œé€šå¸¸æ²¡æœ‰å†…å­˜åœ°å€ï¼Œæˆ–å…¶å†…å­˜åœ°å€åœ¨è¡¨è¾¾å¼ç»“æŸåå°±å¤±æ•ˆ
- å·¦å€¼å¼•ç”¨å°±æ˜¯å¹³æ—¶æœ€æ™®é€šçš„å¼•ç”¨ï¼Œæ‰€ä»¥è§£é‡Šäº†ä¸ºä»€ä¹ˆå®šä¹‰å¼•ç”¨æ—¶è¦è®¾åˆå€¼ï¼Œå› ä¸ºå·¦å€¼æ˜¯å…·æœ‰æŒä¹…çŠ¶æ€ã€æœ‰åœ°å€çš„å¯¹è±¡
- å³å€¼å¼•ç”¨ï¼šå…è®¸ä¸ºå³å€¼åˆ›å»ºä¸€ä¸ªå¼•ç”¨ï¼Œè¿™æ ·å°±å¯ä»¥å¯¹å³å€¼è¿›è¡Œè¯¸å¦‚ç§»åŠ¨è¯­ä¹‰è¿™æ ·çš„å¤æ‚æ“ä½œï¼Œè¿™éƒ¨åˆ†ç•™åˆ°CS106Lå†æ·±å…¥å­¦ä¹ 

### 30.è¯­æ³•å±‚é¢çœ‹ä¸åˆ°çš„åº•å±‚åŸç†

#### â‘ è™šæŒ‡é’ˆå’Œè™šè¡¨

- å­ç±»ç»§æ‰¿çˆ¶ç±»æ—¶ï¼Œå­ç±»çš„å¯¹è±¡ä¹Ÿä¼šæœ‰å†…å­˜å»å­˜å‚¨çˆ¶ç±»privateæˆå‘˜ï¼Œå³ä¸èƒ½è®¿é—® != ä¸å­˜å‚¨ï¼Œå­ç±»ä¸èƒ½è®¿é—®çˆ¶ç±»privateæˆå‘˜ï¼Œä½†åˆ›å»ºå­ç±»å¯¹è±¡æ—¶ï¼Œçˆ¶ç±»privateæˆå‘˜ä¹Ÿä¼šå å†…å­˜
- **è™šå‡½æ•°ã€è™šè¡¨ä¸è™šæŒ‡é’ˆ**
  - å½“ç±»ä¸­æœ‰è™šå‡½æ•°æ—¶ï¼Œå¯¹è±¡ï¼ˆå†…å­˜ï¼‰ä¸­ä¼šæœ‰ä¸€ä¸ªæŒ‡å‘**è™šå‡½æ•°è¡¨(vtable)**çš„æŒ‡é’ˆï¼Œæˆä¸º**è™šè¡¨æŒ‡é’ˆ(vtpr)**ï¼Œæ—¢ç„¶æ˜¯æŒ‡é’ˆï¼Œä½æ•°å’Œåœ°å€ä½æ•°å°±æ˜¯ä¸€æ ·çš„ï¼Œ32ä½ç³»ç»Ÿä¸‹å 4B
  - æ¯ä¸ªå«è™šå‡½æ•°çš„ç±»éƒ½æœ‰ä¸€ä¸ªè™šè¡¨ï¼Œç”¨äºæ”¯æŒè¿è¡Œæ—¶å¤šæ€
  - ==è™šæŒ‡é’ˆå’Œè™šè¡¨å°±ç›¸å½“äºé¡µè¡¨åŸºå€å¯„å­˜å™¨å’Œé¡µè¡¨ï¼Œä¸å¤ªç¡®åˆ‡ï¼Œå¤§æ¦‚è¿™ä¸ªæ„æ€==
  - æ¯ä¸ªç±»çš„è™šå‡½æ•°è¡¨ï¼ŒåŒ…å«è‡ªå·±çš„è™šå‡½æ•°ï¼Œä»¥åŠä»çˆ¶ç±»é‚£ç»§æ‰¿æ¥çš„è™šå‡½æ•°ï¼›å¦‚æœè‡ªå·±é‡å†™äº†çˆ¶ç±»çš„è™šå‡½æ•°ï¼Œé‚£ä¹ˆåªå­˜å‚¨é‡å†™åçš„å³å¯ï¼Œçˆ¶ç±»åŸæœ¬çš„è™šå‡½æ•°å°±ä¸ä¼šå­˜å‚¨

```cpp
class A {
public:
    virtual void vfun1();
    virtual void vfunc2();
    void func1();
    void func2();
private:
    int m_data1;
    int m_data2;
};

class B : public A {
public:
    virtual void vfunc1();
    void func2();
private:
    int m_data3;
};

class C : public B {
public:
    virtual void vfunc1();
    void func2();
private:
    int m_data4;
};
```

![image-20250531160620045](https://raw.githubusercontent.com/mumushu1/Pictures/main/1bcc529a24c2e6ecdd3059299f3a68e8.png)

- å¦‚æœä¸€ä¸ªæŒ‡é’ˆpæŒ‡å‘Cç±»çš„å¯¹è±¡ï¼Œé€šè¿‡æŒ‡é’ˆè°ƒç”¨Cç±»ä¸­çš„è™šå‡½æ•°æ—¶ï¼Œç¼–è¯‘å™¨å‘ç”Ÿçš„åŠ¨ä½œï¼Œç”¨Cè¯­è¨€å¯ä»¥è¡¨ç¤ºä¸º`*(p->vptr)[n]`ï¼Œå³é€šè¿‡æŒ‡é’ˆæ‰¾åˆ°è™šæŒ‡é’ˆï¼Œå–å…¶åœ°å€å°±æ˜¯è™šè¡¨çš„åœ°å€ï¼Œ`[n]`å³ä¸ºè°ƒç”¨è™šè¡¨ä¸­ç¬¬nä¸ªè™šå‡½æ•°
- **é™æ€ç»‘å®šä¸åŠ¨æ€ç»‘å®š**
  - ç»‘å®šï¼šç¨‹åºåœ¨è¿è¡Œæ—¶å†³å®šè°ƒç”¨å“ªä¸ªå‡½æ•°çš„è¿‡ç¨‹
  - é™æ€ç»‘å®šï¼šåœ¨**ç¼–è¯‘æœŸ**å°±å†³å®šè°ƒç”¨å“ªä¸ªå‡½æ•°ï¼Œå¯¹åº”æ±‡ç¼–ä¸­çš„`call`æŒ‡ä»¤ï¼Œ`call 0x 1A234B7F`ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œéè™šå‡½æ•°éƒ½æ˜¯é™æ€ç»‘å®šï¼›æ•ˆç‡é«˜ï¼Œä½†ç¼ºä¹å¤šæ€æ€§
  - åŠ¨æ€ç»‘å®šï¼šåœ¨**è¿è¡Œæ—¶**æ‰å†³å®šè°ƒç”¨å“ªä¸ªå‡½æ•°ï¼Œç”¨äºè™šå‡½æ•°ï¼Œ**ç¨‹åºåœ¨è¿è¡Œæ—¶ä¼šæŸ¥è™šå‡½æ•°è¡¨**ï¼Œæ¥å†³å®šè°ƒç”¨å“ªä¸ªç±»çš„è™šå‡½æ•°ï¼Œæ¯”å¦‚ä¸Šå›¾ä¸­å¦‚æœCå¯¹è±¡è°ƒç”¨`vfunc1()`ï¼Œç¼–è¯‘å™¨åœ¨è¿è¡Œæ—¶æ‰æŸ¥åˆ°`vfucn1()`æ˜¯Cç±»å¯¹è±¡çš„æ‰å»è°ƒç”¨
  - åŠ¨æ€ç»‘å®šçš„ä¸‰ä¸ªæ¡ä»¶
    - å¿…é¡»é€šè¿‡æŒ‡é’ˆå»è°ƒç”¨
    - æŒ‡é’ˆ**å‘ä¸Šè½¬å‹**ï¼ˆä»¥ä¸Šå›¾ä¸ºä¾‹ï¼Œå°±æ˜¯å®šä¹‰æŒ‡å‘Aå¯¹è±¡çš„æŒ‡é’ˆï¼Œå…¶å¼•ç”¨Cï¼Œå³`A* p1 = &c`ï¼Œå­ç±»C->çˆ¶ç±»Aï¼‰
      - ç±»æ¯”ç”Ÿæ´»ä¸­è¿™å¾ˆåˆç†ï¼Œæ¯”å¦‚ç‹—(å­ç±»)->åŠ¨ç‰©(çˆ¶ç±»)ï¼Œä½†åŠ¨ç‰©ä¸èƒ½->ç‹—ï¼Œå‘ä¸Šè½¬å‹æ˜¯å®‰å…¨çš„
    - è™šå‡½æ•°

#### â‘¡å†è°ˆthis

- **ç®€å•è¯´ï¼šthisæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œé€šè¿‡å¯¹è±¡è°ƒç”¨å‡½æ•°ï¼Œå¯¹è±¡çš„åœ°å€å°±æ˜¯this**

```cpp
CDocument::
OnFileOpen(){
    ...
    Serialize();
    ...
}
virtual Serialize();

class CMyDoc : public CDocument{
    virtual Serialize(){...}
};

int main(){
    CMyDoc myDoc;//å­ç±»å¯¹è±¡
    myDoc.OnFileOpen();
}
```

- ä»mainå‡½æ•°å‡ºå‘å»çœ‹ï¼Œå®šä¹‰äº†ä¸€ä¸ªå­ç±»å¯¹è±¡`myDoc`ï¼Œå­ç±»å¯¹è±¡è°ƒç”¨çˆ¶ç±»çš„`OnFileOpen()`
  - è¿™ä¸€æ­¥å½“ç„¶æ˜¯åˆç†çš„ï¼Œå› ä¸ºå­ç±»ç»§æ‰¿çˆ¶ç±»çš„æˆå‘˜å‡½æ•°
  - å¯¹äºæˆå‘˜å‡½æ•°ï¼Œéƒ½æœ‰ä¸€ä¸ªé»˜è®¤çš„å‚æ•°ï¼ˆthisæŒ‡é’ˆï¼‰ï¼Œ**å½“`myDoc`è°ƒç”¨å‡½æ•°æ—¶ï¼Œè¿™ä¸ªå‡½æ•°çš„é»˜è®¤å‚æ•°æ˜¯å­ç±»å¯¹è±¡çš„thisæŒ‡é’ˆ**
  - æ‰€ä»¥è°ƒç”¨æ­¤å‡½æ•°çš„æµç¨‹æ˜¯ï¼Œé¦–å…ˆä¼šæ‰§è¡Œçˆ¶ç±»çš„`onFileOpen()`ï¼Œæ‰§è¡Œåˆ°`Serialize()`æ—¶ï¼Œå®é™…ä¸Šæ˜¯`this->Serialize()`ï¼Œè¿™ä¸ªthisæ˜¯å­ç±»å¯¹è±¡çš„thisï¼Œ`this->Serialize()`å³ä¸º`*(this->vptr)[n](this)`ï¼šå‰ä¸€éƒ¨åˆ†å°±æ˜¯åŠ¨æ€ç»‘å®šæ‰¾è™šå‡½æ•°ï¼Œåé¢çš„thisæ˜¯é»˜è®¤å‚æ•°
- å›é¡¾ä¸Šé¢åŠ¨æ€ç»‘å®šçš„ä¸‰ä¸ªæ¡ä»¶ï¼šé¦–å…ˆæ˜¯æŒ‡é’ˆè°ƒç”¨ï¼ˆè¿™é‡Œæ˜¯thisæŒ‡é’ˆï¼‰ï¼Œå…¶æ¬¡æ˜¯å‘ä¸Šè½¬å‹ï¼ˆè°ƒç”¨æ˜¯å­ç±»çš„å¯¹è±¡è°ƒç”¨ï¼‰ï¼Œæœ€åæ˜¯è™šå‡½æ•°ï¼ˆå®Œå…¨æ»¡è¶³ï¼‰

#### â‘¢å…³äºåŠ¨æ€ç»‘å®š(Dynamic Binding)

- å‰é¢è¯´è¿‡ï¼Œå¯¹äºä¸€ä¸ªé™æ€ç»‘å®šï¼Œå¯¹åº”ä¸€ä¸ªæ±‡ç¼–ä¸­çš„callæŒ‡ä»¤ï¼Œè€Œä¸”**callçš„ä¸€å®šæ˜¯ä¸€ä¸ªç¡®å®šçš„åœ°å€**
- è€Œå¯¹äºåŠ¨æ€ç»‘å®šï¼Œä¹Ÿæ˜¯callï¼Œä½†callçš„å†…å®¹ä¸åŒï¼Œè¿™é‡Œæ±‡ç¼–çš„å«ä¹‰æˆ‘ä»¬å°±ä¸å»äº†è§£äº†ï¼Œå…¶å®ç°çš„åŠŸèƒ½å°±æ˜¯`*(p->vptr)[n]`

<img src="https://raw.githubusercontent.com/mumushu1/Pictures/main/b4bd5a0c226347f78a0dfa043e1dfe2d.png" alt="image-20250605094650985" style="zoom:50%;" />	

### 31.å†è°ˆconst - è¡¨è¾¾æ„å›¾

#### â‘ conståŸºæœ¬æ¦‚å¿µ

- **ä¸€å¥è¯æ˜ç™½const ï¼šç”¨äºæŒ‡ç¤ºå˜é‡çš„å€¼ä¸å¯ä¿®æ”¹**

- constå®šä¹‰çš„å˜é‡å¿…é¡»åˆå§‹åŒ–ï¼Œ**å…¨å±€constå˜é‡ä¸€èˆ¬å­˜å‚¨åœ¨åªè¯»æ•°æ®æ®µï¼Œå±€éƒ¨constå˜é‡ï¼ˆä¾‹å¦‚å‡½æ•°ä¸­ï¼‰åˆ™å­˜å‚¨åœ¨å‡½æ•°æ ˆä¸­**

- ç¼–è¯‘å™¨å¦‚ä½•å¤„ç†constå˜é‡ï¼š**ç¼–è¯‘å™¨åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­å°†æ‰€æœ‰ç”¨åˆ°è¯¥å˜é‡çš„åœ°æ–¹éƒ½æ›¿æ¢æˆå¯¹åº”çš„å€¼**

  - å›æƒ³ä¸€ä¸‹ç¬¬33å°ç»“å…³äºexternå…³é”®å­—ï¼Œæˆ‘ä»¬è¯´è¿‡å¤´æ–‡ä»¶ç”¨äºå£°æ˜ï¼Œæºæ–‡ä»¶ç”¨äºå®ç°
  - å¯¹äºconstå˜é‡ï¼Œæœ‰ä¸¤ç§å£°æ˜ï¼ˆå®šä¹‰ï¼‰æ–¹å¼
    - å¤´æ–‡ä»¶externå£°æ˜ã€æºæ–‡ä»¶å†å®šä¹‰ï¼ˆ33å°èŠ‚ä»‹ç»çš„å¸¸è§„æ–¹æ³•ï¼Œ**æ²¡å‰¯æœ¬ï¼Œæ‰€æœ‰æºæ–‡ä»¶å…±äº«è¿™ä¸€ä¸ªconstå˜é‡**ï¼‰
    - å¤´æ–‡ä»¶ä¸­ç›´æ¥å®Œæˆå¯¹constå˜é‡çš„å®šä¹‰
      - è¿™æ ·çš„åˆç†æ€§ï¼šç¼–è¯‘å™¨ä¼šå¯¹è¿™ä¸ªconstå˜é‡æ¯ä¸ªç”¨åˆ°çš„åœ°æ–¹ç”Ÿæˆä¸€ä¸ª**å‰¯æœ¬**ï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ªå˜é‡ï¼ˆå®é™…ä¸Šæ˜¯ä¸€ä¸ªå€¼ï¼‰
      - æ‰€ä»¥ä¸ä¼šå‡ºç°é‡å®šä¹‰çš„é—®é¢˜ï¼Œä¸ä¼šæŠ¥é”™

  ```cpp
  const int MAXSIZE = 100;//æ³¨æ„ä¸åŠ externï¼Œexternæ˜¯ç”¨äºå£°æ˜çš„å…³é”®å­—
  ```

#### â‘¡constä¸æˆå‘˜å‡½æ•°

- ==åœ¨å®ç°ä¸€ä¸ªæˆå‘˜å‡½æ•°æ—¶ï¼Œå°±éœ€è¦è€ƒè™‘è¦ä¸è¦åŠ constï¼Œè¿™æ˜¯ä¸€ä¸ªå¯ä»¥å¾ˆæ—©æœŸå®Œæˆçš„å·¥ä½œ==

|                                             | å¯¹è±¡æ˜¯constï¼ˆæˆå‘˜å˜é‡ä¸èƒ½æ”¹å˜ï¼‰ | å¯¹è±¡ä¸æ˜¯constï¼ˆæˆå‘˜å˜é‡å¯ä»¥æ”¹å˜ï¼‰ |
| ------------------------------------------- | ------------------------------- | --------------------------------- |
| **è°ƒç”¨çš„å‡½æ•°æ˜¯constï¼ˆä¿è¯ä¸æ”¹å˜dataï¼‰**     | âœ”ï¸                               | âœ”ï¸                                 |
| **è°ƒç”¨çš„å‡½æ•°ä¸æ˜¯constï¼ˆä¸ä¿è¯ä¸æ”¹å˜dataï¼‰** | âŒ                               | âœ”ï¸                                 |

- åŠ constå’Œä¸åŠ constï¼Œç®—ä½œâ€œå‡½æ•°ç­¾åâ€çš„ä¸€éƒ¨åˆ†ï¼Œå³åŠ ä¸åŠ constæ˜¯ä¸¤ä¸ªå‡½æ•°ï¼Œå¯ä»¥å…±å­˜ï¼ˆå¯¹æ¯”å‡½æ•°çš„è¿”å›ç±»å‹ï¼Œä¸å±äºç­¾åçš„éƒ¨åˆ†ï¼‰
- **C++è§„åˆ™æ€ªè°ˆï¼šå½“æˆå‘˜å‡½æ•°çš„constç‰ˆæœ¬å’Œnon-constç‰ˆæœ¬åŒæ—¶å­˜åœ¨æ—¶ï¼Œconstå¯¹è±¡åªèƒ½è°ƒç”¨constç‰ˆæœ¬çš„ï¼Œnon-constå¯¹è±¡åªèƒ½è°ƒç”¨non-constç‰ˆæœ¬çš„**ï¼Œå³è¡¨æ ¼å³ä¸Šè§’çš„æƒ…å†µåœ¨æ­¤æ—¶ä¸ä¼šå‡ºç°

#### â‘¢constä¸å¼•ç”¨

- å¸¸é‡ä¹Ÿå¯ä»¥ç»‘å®šå¼•ç”¨ï¼Œç§°ä¸ºå¯¹å¸¸é‡çš„å¼•ç”¨ï¼Œå¯¹å¸¸é‡çš„å¼•ç”¨ä¸å¯ä¿®æ”¹å…¶ç»‘å®šçš„å¯¹è±¡

```cpp
const int MAXSIZE = 100;
const int& r = MAXSIZE;
```

- ä¸€ä¸ªå¸¸é‡å¼•ç”¨ï¼Œç»‘å®šéå¸¸é‡ï¼Œæ˜¯è¢«å…è®¸çš„

```cpp
int x = 1;
const int& r = x;
```

- ä»¥ä¸‹ä»£ç ç¼–è¯‘æ˜¯é€šè¿‡çš„ï¼ˆæ²¡æœ‰constæ˜¯éæ³•çš„ï¼‰ï¼Œå› ä¸ºç”¨äº†constï¼ŒC++ä¼šå…è®¸**ä¸´æ—¶å˜é‡çš„ç»‘å®š**ï¼Œå®é™…åå°ï¼š
  - `const int temp  = pi;`
  - `const int &r = temp;`

```cpp
double pi = 3.14;
const int& r = pi;
```

#### â‘£constä¸æŒ‡é’ˆ

- æŒ‡é’ˆä¹Ÿæ˜¯åŒç†çš„ï¼Œä¹Ÿå¯ä»¥æŒ‡å‘å¸¸é‡ï¼Œä¸”ä¸å¯é€šè¿‡æŒ‡é’ˆä¿®æ”¹å¸¸é‡å€¼ï¼Œå¸¸é‡å¯¹è±¡åªèƒ½ç”±**å¸¸é‡æŒ‡é’ˆ**æŒ‡å‘ï¼Œéå¸¸é‡å¯¹è±¡å¯ä»¥ç”±å¸¸é‡æŒ‡é’ˆæŒ‡å‘ï¼ˆæœ‰ç‚¹ç»•ï¼Œå¤šè¯»ä¸¤éå°±æ‡‚äº†ï¼‰
  - ==**å¸¸é‡æŒ‡é’ˆï¼š**æŒ‡å‘çš„å†…å®¹æ˜¯å¸¸é‡çš„æŒ‡é’ˆï¼Œä¸èƒ½ä¿®æ”¹å†…å®¹ï¼ˆå› ä¸ºæŒ‡çš„å¸¸é‡ï¼‰ï¼Œä½†å¯ä»¥æŒ‡å‘åˆ«çš„åœ°æ–¹==

```cpp
const int MAXSIZE = 100;
const int* p = &MAXSIZE;

int x = 1;
const int* q = &x;
```

- ==**æŒ‡é’ˆå¸¸é‡**ï¼šæœ¬èº«æ˜¯å¸¸é‡çš„æŒ‡é’ˆï¼Œä¸èƒ½ä¿®æ”¹æŒ‡å‘çš„åœ°æ–¹ï¼ˆå› ä¸ºæŒ‡é’ˆå°±æ˜¯å¸¸é‡ï¼‰ï¼Œä½†å¯ä»¥ä¿®æ”¹å†…å®¹==

> äºŒè€…éƒ½æ˜¯æŒ‡é’ˆï¼ŒæŒ‡é’ˆå¸¸é‡è¡¨ç¤ºè¿™ä¸ªæŒ‡é’ˆæ˜¯ä¸ªå¸¸é‡ï¼Œä¸èƒ½æ”¹åœ°å€ï¼ˆæŒ‡å‘è°ï¼‰ï¼Œä½†èƒ½æ”¹æŒ‡å‘å¯¹è±¡çš„å€¼ï¼›å¸¸é‡æŒ‡é’ˆè¡¨ç¤ºè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘å¸¸é‡ï¼Œæ‰€ä»¥ä¸èƒ½æ”¹æŒ‡å‘å¯¹è±¡çš„å€¼ï¼Œä½†å¯ä»¥æ›´æ”¹åœ°å€ï¼ˆæŒ‡å‘è°ï¼‰

#### â‘¤é¡¶å±‚constä¸åº•å±‚const	

- é¡¶å±‚constï¼šè¡¨ç¤º**ä»»æ„å¯¹è±¡**æ˜¯å¸¸é‡ï¼Œè¿™ä¸€ç‚¹å¯¹ä»»ä½•æ•°æ®ç±»å‹éƒ½é€‚ç”¨ - ç®—æœ¯ç±»å‹ ã€ç±»ã€æŒ‡é’ˆç­‰

```cpp
const int x = 1;//é¡¶å±‚constï¼Œconstç›´æ¥ä¿®é¥°å˜é‡æœ¬èº«

int* const p = &x;//é¡¶å±‚constï¼Œä¿®é¥°æŒ‡é’ˆæœ¬èº«
```

- åº•å±‚constï¼šè¡¨ç¤º**æŒ‡é’ˆæŒ‡å‘çš„å†…å®¹ä¸èƒ½ä¿®æ”¹**ï¼Œå¸¸ç”¨äºæŒ‡é’ˆæˆ–å¼•ç”¨çš„å†…å®¹æ˜¯å¸¸é‡çš„æƒ…å†µ

```cpp
const int* p = &x;//åº•å±‚constï¼Œpæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œconstä¿®é¥°çš„æ˜¯*pï¼ˆä¹Ÿå°±æ˜¯pæŒ‡å‘çš„å†…å®¹ï¼‰
```

- one example

```cpp
const int* const p3 = p2;//å·¦è¾¹çš„constæ˜¯åº•å±‚constï¼Œå³è¾¹çš„æ˜¯é¡¶å±‚const
```

#### â‘¥å½“consté‡åˆ°åˆ«å(using & typedef)

- **`const`ä¿®é¥°çš„æ˜¯æ•´ä¸ªåˆ«åï¼Œä¸æ˜¯åˆ«åé‡Œé¢çš„ç±»å‹å†…å®¹**å—ï¼Œè¿™é‡ŒæŒºç»•çš„ï¼Œå®é™…å†™çš„æ—¶å€™å°½é‡åˆ«è¿™ä¹ˆå†™

```cpp
using pstring = char*;
const pstring cstr = 0;//ç›¸å½“äºchar* const cstrï¼Œcstræœ¬èº«ä¸å¯å˜
const pstring *ps;//ç›¸å½“äºchar* const *psï¼Œ*psæœ¬èº«ä¸å¯å˜
```

### 32.è¯¦è§£newå’Œdelete

#### â‘ åŸºæœ¬è®¤çŸ¥

- å¯¹äºç±»çš„å¯¹è±¡è€Œè¨€ï¼Œnewä¼šè°ƒç”¨æ„é€ å‡½æ•°ï¼Œdeleteä¼šè°ƒç”¨ææ„å‡½æ•°
- `newã€delete`ï¼šåˆ†é…/é‡Šæ”¾ä¸€ä¸ªå¯¹è±¡
- `new[]ã€delete[]`ï¼šåˆ†é…/é‡Šæ”¾ä¸€ç»„å¯¹è±¡
- newçš„åº•å±‚åŸç†
  1. è°ƒç”¨`operator new(size)`åˆ†é…å†…å­˜ï¼ˆåº•å±‚å°±æ˜¯mallocï¼‰
  2. åœ¨åˆ†é…å¥½çš„å†…å­˜ä¸Šè°ƒç”¨æ„é€ å‡½æ•°
- deleteçš„åº•å±‚åŸç†
  1. å…ˆè°ƒç”¨ææ„å‡½æ•°
  2. è°ƒç”¨`operator delete(ptr)`é‡Šæ”¾å†…å­˜ï¼ˆåº•å±‚å°±æ˜¯free(ptr)ï¼‰ï¼ŒptræŒ‡å‘è¿™ç‰‡ç©ºé—´çš„é¦–åœ°å€
  3. freeé€šè¿‡æŸ¥æ‰¾éšè—çš„å¤´éƒ¨å¾—çŸ¥é‡Šæ”¾çš„å†…å­˜å—å¤§å°
     - delete[]å¦‚ä½•çŸ¥é“å…ƒç´ ä¸ªæ•°ï¼šnew[]é¢å¤–åˆ†é…äº†ç©ºé—´ï¼Œåœ¨æ•°ç»„å‰å­˜å‚¨äº†å…ƒç´ ä¸ªæ•°ï¼ˆç”¨æˆ·çœ‹ä¸åˆ°ï¼‰
- newéœ€è¦çŸ¥é“åˆ†é…å¤šå¤§å†…å­˜ï¼Œéœ€è¦ä¸€ä¸ªsizeï¼Œè€Œdelete

- å¯ä»¥é€šè¿‡é‡è½½`operator`æ¥è‡ªå®šä¹‰åˆ†é…å™¨

#### â‘¡é‡è½½operator newã€operator deleteã€operator new[]ã€operator delete[]

- ä¸‹é¢è¿™æ®µä»£ç å½±å“æ— è¿œå¼—å±Šï¼Œä½†ç›®å‰å°šæœªå‚é€ï¼Œç•™å¾—ä¹‹åå­¦ä¹ 

```cpp
//å°è£… malloc/free çš„é€šç”¨å†…å­˜åˆ†é…å™¨,å¯ä»¥ç”¨æ¥åˆ†é…ä»»ä½•ç±»å‹çš„å†…å­˜
//*void:é€šç”¨æŒ‡é’ˆç±»å‹ï¼Œå¯ä»¥æŒ‡å‘ä»»ä½•ç±»å‹
//size_t:æ— ç¬¦åˆæ•´æ•°ç±»å‹
void* myAlloc(size_t size) {
    return malloc(size);
}

void myFree(void* ptr) {
    return free(ptr);
}

inline void* operator new(size_t size) {
    cout << "è¿™æ˜¯é‡è½½çš„new" << endl;
    return myAlloc(size);
}

inline void* operator new[](size_t size) {
    cout << "è¿™æ˜¯é‡è½½çš„new[]" << endl;
    return myAlloc(size);
}

inline void operator delete(void* ptr) {
    cout << "è¿™æ˜¯é‡è½½çš„delete" << endl;
    return myFree(ptr);
}

inline void operator delete[](void* ptr) {
    cout << "è¿™æ˜¯é‡è½½çš„delete[]" << endl;
    return myFree(ptr);
}
```

- ä¹Ÿå¯ä»¥å¯¹ç±»æˆå‘˜å‡½æ•°newã€new[]ã€deleteã€delete[]è¿›è¡Œé‡è½½ï¼Œç”¨åšå†…å­˜æ± ï¼Œè¿™é‡Œæœ‰å¾…ç»§ç»­ç ”ç©¶

### 33.externå…³é”®å­—

- æˆ‘ä»¬çŸ¥é“ï¼Œå¤´æ–‡ä»¶ä¸€èˆ¬ä½œä¸ºå£°æ˜ï¼Œæºæ–‡ä»¶ç”¨æ¥åšå®ç°ï¼Œç°åœ¨è®¾æƒ³è¿™æ ·ä¸€ç§åœºæ™¯ï¼Œåœ¨å¤´æ–‡ä»¶ä¸­å®šä¹‰å˜é‡
- `test.h`ä¸­å®šä¹‰x,yï¼Œ`test.cpp`å’Œ`main.cpp`éƒ½åŒ…å«`test.h`

```cpp
//test.h
int x = y = 1;

//main.cpp
std::cout << x << y;
```

- ç¨‹åºåœ¨é“¾æ¥æ—¶ä¼šæŠ¥é”™ï¼š`multiple definition of x`,`multiple definition of  y`,åŸå› æ˜¯**æ¯ä¸ªåŒ…å«test.hçš„æ–‡ä»¶ï¼Œéƒ½ä¼šå°†è¿™æ®µä»£ç èµ‹å€¼åˆ°æ¯ä¸ªæºæ–‡ä»¶ä¸­ï¼Œå³test.cppå’Œmain.cppéƒ½å®šä¹‰äº†ä¸€éxå’Œy**ï¼Œè¿™å°±è¿åäº†C++çš„**ODR**
- ODRï¼šOne Definition Ruleï¼Œå”¯ä¸€å®šä¹‰è§„åˆ™ï¼Œåœ¨ä¸€ä¸ªç¨‹åºä¸­ï¼ŒæŸä¸ªå…¨å±€å˜é‡ï¼ˆæˆ–å‡½æ•°ã€ç±»ã€æ¨¡æ¿ç­‰ï¼‰ï¼Œ**æœ€å¤šåªèƒ½æœ‰1ä¸ªå®šä¹‰ï¼Œä½†å¯ä»¥åœ¨å¤šä¸ªåœ°æ–¹å£°æ˜**

> ä¹Ÿå°±æ˜¯è¯´C++çš„includeï¼Œä¼šæŠŠincludeçš„é‚£ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼ˆå˜é‡ã€å‡½æ•°ç­‰ç­‰ï¼‰å¤åˆ¶ä¸€éï¼Œå¯¹äºå˜é‡æ¥è¯´ï¼Œå¦‚æœincludeçš„é‚£ä¸ªæ–‡ä»¶å®šä¹‰äº†è¯¥å˜é‡ï¼Œé‚£ä¹ˆåœ¨includeå®ƒæ—¶å°±ä¼šå°†è¿™ä¸ªå˜é‡å†å®šä¹‰ä¸€éï¼Œå¯¼è‡´å‡ºé”™ã€‚

- å¦‚ä½•è§£å†³ï¼šå¼•å…¥**extern**å…³é”®å­—
- ä¸€ä¸ªä¸€èˆ¬åŒ–çš„åšæ³•

```cpp
//test.h
extern std::string str;;//ä¸è¦èµ‹å€¼ï¼Œèµ‹å€¼åå°±æ˜¯å®šä¹‰äº†

//test.cpp
std::string str = "Hello World";;//å¯¹å˜é‡èµ‹å€¼å®Œæˆå®šä¹‰

//main.cpp
std::cout << str
```

- æ€»ç»“
  - å¤´æ–‡ä»¶åªåšå˜é‡çš„å£°æ˜ï¼Œä¸åšå˜é‡çš„å®šä¹‰
  - å¤´æ–‡ä»¶å£°æ˜å˜é‡å¯ä»¥é‡‡ç”¨externçš„æ–¹å¼

### 34.è¯­å¥

#### â‘ gotoè¯­å¥

- ç±»ä¼¼æ±‡ç¼–ä¸­çš„jmpæŒ‡ä»¤ï¼Œä½¿ç¨‹åºæ— æ¡ä»¶è·³è½¬åˆ°å®šä¹‰çš„æ ‡ç­¾å¤„
- ä¸æ¨èé¢‘ç¹ä½¿ç”¨ï¼Œä¼šä½¿ç¨‹åºæµéš¾ä»¥ç†è§£å’Œç»´æŠ¤

```cpp
int num;
cout << "è¾“å…¥ä¸€ä¸ªæ­£æ•°" << endl;
cin >> num;

if (num < 0) {
    goto end;
}
else {
    cout << "æ‚¨è¾“å…¥çš„æ•°ä¸º:" << num << endl;
}

end:
cout << "è¾“å…¥ä¸ºè´Ÿï¼Œç¨‹åºç»“æŸ" << endl;

return 0;
}
```

#### â‘¡å¼‚å¸¸å¤„ç†è¯­å¥

##### 1ï¼‰try catch å’Œ throwè¯­å¥

> é¢„é˜²ç¨‹åºè¿è¡Œæ—¶å¯èƒ½å‡ºç°çš„å¼‚å¸¸

- **`try`å—ï¼šåŒ…å«å¯èƒ½å¼•å‘å¼‚å¸¸çš„ä»£ç **
- `catch`å—ï¼šæ•è·å¹¶å¤„ç†å¼‚å¸¸
- `throw`ï¼šæŠ›å‡ºå¼‚å¸¸ï¼Œé€šå¸¸åœ¨å®ç°å¯èƒ½å‡ºç°å¼‚å¸¸çš„ç¨‹åºæ—¶ä½¿ç”¨

```cpp
double divide (double molecular,double denominator) {
    if (denominator == 0) {
        throw std::invalid_argument("é™¤æ•°ä¸º0");//æŠ›å‡ºå¼‚å¸¸
    }
    return molecular / denominator;
}


int main() {
    SetConsoleOutputCP(CP_UTF8); // è®¾ç½®è¾“å‡ºä¸º UTF-8
    SetConsoleCP(CP_UTF8);       // è®¾ç½®è¾“å…¥ä¸º UTF-8

    double molecular,denominator;
    cin >> molecular >> denominator;

    try {
        double res = divide(molecular,denominator);
        cout << "res = " << res << endl;
    }catch (std::invalid_argument &e) {
        cout << "å¼‚å¸¸:" << e.what() << endl;
    }
    cout << "try-catchåç¨‹åºç»§ç»­"  << endl;
    //1 0
    //å¼‚å¸¸:é™¤æ•°ä¸º0
    //try-catchåç¨‹åºç»§ç»­
```

- **å…³äºcatchå‚æ•°**

  - æ•è·**ç‰¹å®šç±»å‹å¼‚å¸¸**ï¼Œå‚æ•°å†™å¼‚å¸¸ç±»å‹å¯¹è±¡çš„å¼•ç”¨
  - æ ‡å‡†åº“ä¸­çš„ç‰¹å®šç±»å‹å¼‚å¸¸ï¼šæ”¾åœ¨<stdexcept>ä¸­ï¼Œå¤ªå¤šäº†ï¼Œå†™ä¸‰ä¸ªåŸºç±»

  > https://en.cppreference.com/w/cpp/header/stdexcept.html

  > | ç±»å                 | è¯´æ˜                                           |
  > | -------------------- | ---------------------------------------------- |
  > | `std::exception`     | æ‰€æœ‰æ ‡å‡†å¼‚å¸¸çš„åŸºç±»ï¼Œå‡ ä¹æ‰€æœ‰å¼‚å¸¸éƒ½å¯ä»¥ç”¨å®ƒæ•è· |
  > | `std::logic_error`   | é€»è¾‘é”™è¯¯ï¼Œç¨‹åºè®¾è®¡é”™è¯¯å¯¼è‡´çš„å¼‚å¸¸               |
  > | `std::runtime_error` | è¿è¡Œæ—¶é”™è¯¯ï¼Œç¨‹åºè¿è¡Œæ—¶å‡ºç°çš„å¼‚å¸¸               |

  ```cpp
  try {
      throw runtime_error("è¿è¡Œæ—¶é”™è¯¯");
  }
  catch (const runtime_error& e){
      cout << e.what();
  }
  ```

  - æ•è·**æ™®é€šç±»å‹**ï¼ˆéå¼‚å¸¸ç±»å‹ï¼‰ï¼Œå‚æ•°å¯ä»¥ç›´æ¥å†™ç±»å‹å

  ```cpp
  try {
      throw 24;
  }
  catch (int num) {
      cout << "æ•è·åˆ°int:" << num;
   }
  ```

  - æ•è·**æ‰€æœ‰ç±»å‹**

  ```cpp
  try {
      throw "é”™è¯¯";
  }
  catch (...) {
      cout << "æ•è·åˆ°æœªçŸ¥å¼‚å¸¸";
  }
  ```

##### 2ï¼‰å¤šé‡catchå—

- å¯ä»¥ä¸º`try`æŒ‡å®šå¤šä¸ª`catch`å—ï¼Œç”¨æ¥æ•è·ä¸åŒç±»å‹çš„å¼‚å¸¸

```cpp
try {
    cout << "input a num:" << endl;
    int num;
    cin >> num;

    if (num == 0) {
        throw runtime_error("è¿è¡Œæ—¶é”™è¯¯ï¼šè¾“å…¥ä¸º0"); //æ‹¬å·çš„å†…å®¹å³ä¸ºe.what()çš„å†…å®¹
    } else if (num < 0) {
        throw invalid_argument("éæ³•å‚æ•°ï¼Œè¾“å…¥ä¸ºè´Ÿ");
    } else if (num > 100) {
        throw runtime_error("è¿è¡Œæ—¶é”™è¯¯ï¼Œè¾“å…¥è¶…è¿‡100");
    } else {
        cout << "ä½ è¾“å…¥çš„æ˜¯:" << num << endl;
    }
}
catch (const runtime_error& e) {
    cout << "æ•è·å¼‚å¸¸ä¸ºï¼š" << e.what() << endl;
}
catch (const invalid_argument& e) {
    cout << "æ•è·å¼‚å¸¸ä¸º:" << e.what() << endl;
}
catch (...) {
    cout << "æ•è·æœªçŸ¥å¼‚å¸¸" << endl;
}
```

##### 3ï¼‰throwé€šå¸¸ä½ç½®

- **throwå¯ä»¥åœ¨ä»»ä½•å¯èƒ½å‡ºç°å¼‚å¸¸ä¸”éœ€è¦å¼•å‘çš„ä½ç½®å‡ºç°**ï¼ŒåŒ…æ‹¬å‡½æ•°å†…éƒ¨ï¼ŒåµŒå¥—è°ƒç”¨ä¸­ ç­‰

##### 4ï¼‰rethrowå¼‚å¸¸

å¯ä»¥åœ¨`catch`å—ä¸­é‡æ–°`throw`æ•è·çš„å¼‚å¸¸ï¼Œä»¥ä¾¿å…¶ä»–éƒ¨åˆ†å¤„ç†

> `func1` æŠ›å‡ºå¼‚å¸¸ã€‚
>
> `func2` è°ƒç”¨ `func1`ï¼Œæ•è·å¼‚å¸¸åé‡æ–°æŠ›å‡ºã€‚
>
> `main` æœ€ç»ˆæ•è·å¹¶å¤„ç†å¼‚å¸¸ã€‚

```cpp
void func1 () {
    throw runtime_error("å¼‚å¸¸å™œ");
}

void func2 () {
    try {
        func1();
    } catch (...) {
        cout << "åœ¨func2æ•è·ä½ å™œ" << endl;
        throw;//é‡æ–°æŠ›å‡ºå¼‚å¸¸
    }
}

int main() {
    SetConsoleOutputCP(CP_UTF8); // è®¾ç½®è¾“å‡ºä¸º UTF-8
    SetConsoleCP(CP_UTF8);       // è®¾ç½®è¾“å…¥ä¸º UTF-8

    try {
        func2();
    }catch (...) {
        cout << "åœ¨mainä¸­æ•è·ä½ å™œ" << endl;
    }
    return 0;
}
//è¾“å‡º
åœ¨func2æ•è·ä½ å™œ
åœ¨mainä¸­æ•è·ä½ å™œ
```

